# C#

## 난이도 : 골드 2

## 알고리즘 분류
  - 이분 탐색
  - 삼분 탐색

## 제한조건
  - 시간 제한 : 2초
  - 메모리 제한 : 128 MB

## 문제
원숭이는 나무에 산다. 원숭이의 나라는 2차원의 정수좌표로 나타낼 수 있다.<br/>
땅은 X축에 있고, 나무는 모두 X축의 정수좌표에 심어져 있다. 나무는 수직으로만 자라고, 이 나라에서 나무는 밑으로도 자란다.<br/>
원숭이는 나무에서 위아래로만 이동할 수 있다. 원숭이도 나무에서 떨어질 수 있기 때문에, 나무에서 나무로 점프하는 위험한 행동은 하지 않는다. 그리고 땅에서는 좌우로 이동하거나, 나무를 탈 수 있다.<br/>
원숭이들을 서로 다른 좌표에 위치해 있다. 원숭이들의 거리는 다음과 같이 구한다.<br/>

  1. 만약 두 원숭이가 같은 X좌표에 있다면 (같은 나무에 있다면) 두 원숭이의 거리는 Y좌표의 차이이다.
  2. 만약 두 원숭이가 다른 X좌표에 있다면 (다른 나무에 있다면) 두 원숭이의 거리는 땅과 원숭이 1 사이의 거리 + 땅과 원숭이 2 사이의 거리 + 그들의 X좌표의 차이 이다.

원숭이들의 왕 엔토피아는 원숭이들의 생활을 좀 더 편하게 해주기 위해서 땅을 옮기려고 한다.<br/>
엔토피아는 각 원숭이들의 거리의 최댓값을 최소화하려고 한다.<br/>
땅을 옮길때는 Y=N과 같이 X축에 수평인 방향으로만 옮길 수 있다. 땅을 옮기지 않을 수도 있다. 이때, N은 항상 정수이어야 한다.<br/>
원숭이의 위치가 주어졌을 때, 땅을 옮기거나 옮기지 않아서 원숭이들의 거리의 최댓값의 최솟값을 출력한다.<br/>


## 입력
첫째 줄에 원숭이가 몇 마리 있는 지 주어진다. 원숭이는 적어도 2마리는 존재하며, 50마리를 넘지 않는다. 둘째 줄에 각 원숭이들의 좌표가 주어진다. 원숭이들의 좌표는 X좌표 Y좌표 순으로 주어진다. 좌표의 절댓값은 1,000,000,000보다 작거나 같다. 두 원숭이가 같은 위치에 있는 경우는 없다.<br/>


## 출력
첫째 줄에 원숭이들의 거리의 최댓값의 최솟값을 출력한다.<br/>


## 예제 입력
4<br/>
1 1<br/>
1 10<br/>
1 100<br/>
1 1000<br/>


## 예제 출력
999<br/>


## 풀이
(x1, y1), (x2, y2)에 위치한 두 원숭이들 사이의 거리 d는 문제조건으로부터 다음과 같다.<br/>
여기서 |A|는 A의 절댓값을 의미한다.<br/>

  1. 땅이 y1, y2 사이에 존재하는 경우 : d = |x2 - x1| + |y2 - y1|
  2. 땅이 y1, y2 사이에 존재하지 않는 경우 : 땅의 위치를 k, 최솟값 함수를 Min이라 할 때, d = |x2 - x1| + |y2 - y1| + 2 x Min(|k - y1|, |k - y2|)


원숭이간 거리가 dis라 할 때, dis + 1이 되게 땅을 조절할 수 있다.<br/>


실제로 만약 두 원숭이 y위치 중 작은 것을 min, 큰 것을 max라 하자.<br/>
땅이 max보다 크거나 같은 경우 위로 0.5만큼 이동한다.<br/>
땅이 min보다 작거나 같은 경우 아래로 0.5만큼 이동한다.<br/>
반면 min과 max 사이에 있는 경우 땅을 max + 0.5위치나 min - 0.5위치로 이동시키면 된다.<br/>
모든 경우에 대해 땅의 위치를 적절히 조절함으로써 거리 d를 dis + 1로 만들 수 있다.<br/>


그래서 원숭이간 최대 거리를 Dis라 하면 최대 거리를 Dis + 1이 되게 땅을 조절할 수 있다.<br/>
이로 최대거리로 가능한 정수를 1, 불가능한 정수를 0이라 하면이는 0, 0, 0, 0, ..., 0, 1, 1, 1, ... 1인 정렬된 집합이됨을 알 수 있다.<br/>
그래서 이분 탐색으로 원숭이간 최대 거리가 가능한지 찾아줄 수 있다.<br/>
원숭이들의 좌표 값의 범위가 절댓값을 했을 때 10억보다 작거나 같은 정수라 했으므로 최대 거리는 0 ~ 40억이 된다.<br/>


이제 최대 거리 Dis가 가능한지 판정해야 한다.<br/>
거리 공식으로 |x2 - x1| + |y2 - y1| > Dis인 (x1, y1), (x2, y2)에 위치한 원숭이가 존재하면 이는 불가능함을 알 수 있다.<br/>


|x2 - x1| + |y2 - y1| ≤ Dis인 경우에 한해서 본다.<br/>
거리 공식에서 땅의 위치를 k라 하면 d = |x2 - x1| + |y2 - y1| + 2 x Min(|k - y1|, |k - y2|)이었다.<br/>
Dis는 원숭이간 최대 거리이므로 Dis ≥ |x2 - x1| + |y2 - y1| + 2 x Min(|k - y1|, |k - y2|)이다.<br/>
여기서 C = (Dis - |x2 - x1| - |y2 - y1|) / 2라 하면 위 등식은 C ≥ Min(|k - y1|, |k - y2|)이다.<br/>


이로 Dis에 따라 k의 범위를 구할 수 있다.<br/>
Min은 최솟값 함수, Max는 최댓값 함수라 할 때, min = Min(y1, y2), max = Max(y1, y2)라 하자.<br/>
그러면 min - C ≤ k ≤ max + C를 얻는다.<br/>


이렇게 모든 원숭이 쌍에 대해 k의 범위들의 교집합을 찾고 해당 교집합이 정수 좌표를 포함하는지 확인하면서 Dis가 가능한지 판별할 수 있다.<br/>
이 경우 모든 원숭이 쌍을 비교해야하므로 원숭이 수를 N이라 하면 N^2에 유효한지 판별할 수 있다.<br/>


원숭이 수 N은 50이하이므로 판별하는 경우는 2500번을 넘지 않는다.<br/>
그리고 이분 탐색 범위 역시 0 ~ 40억이므로 log 40억 < 34가 된다.<br/>
그래서 해당 문제의 시간 복잡도는 M을 탐색 범위라 하면 O(N^2 log M)이고 시간 제한이 2초이므로 유효한 방법이다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/1425