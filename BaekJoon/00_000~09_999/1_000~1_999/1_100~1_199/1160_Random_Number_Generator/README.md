# C#

## 난이도 : 플레티넘 5

## 알고리즘 분류
  - 수학
  - 분할 정복을 이용한 거듭제곱

## 제한조건
  - 시간 제한 : 2초
  - 메모리 제한 : 128 MB

## 문제
홍준이는 통계학을 공부하다가 ‘무작위 추출’의 매력에 푹 빠졌고, 난수 발생기를 이용해 직접 ‘무작위 추출’을 한다. 홍준이는 일차 점화식으로 생성되는 수열을 이용한 난수 발생기가 적당하다고 생각했다. 수열을 만들기 위해서는 음이 아닌 정수 m, a, c, X0이 필요하다. 수열 <Xn>의 점화식은 다음과 같다:<br/>
Xn+1 = (aXn + c) mod m<br/>
"A mod m"이라는 말은 A를 m으로 나눈 나머지를 뜻한다.<br/>
최종적으로, Xn을 양의 정수 g로 나눈 나머지가 난수로 사용한다. 따라서 생성된 난수는 0, 1, …, g-1사이의 값을 가지게 될 것이다.<br/>
착한 명우는, 친구 홍준이의 속마음을 읽고, 난수 발생기를 만들어주려고 한다. 명우를 도와 홍준이에게 줄 난수 발생기 프로그램을 작성하시오.<br/>


## 입력
첫째 줄에 6개의 정수 m, a, c, X0, n, g (m, a, c, X0, n ≤ 10^18, g ≤ 10^8)가 차례대로 주어진다. a, c, X0는 음이 아닌 정수이고 m, n, g는 양의 정수이다.<br/>


## 출력
첫째 줄에 Xn mod g의 값을 출력한다.<br/>


## 예제 입력
11 8 7 1 5 3<br/>


## 예제 출력
2<br/>


## 힌트
예제 입력으로 생성되는 수열 <Xn>을 구해보면 아래와 같다.<br/>

|k|0|1|2|3|4|5|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|Xk|1|4|6|0|7|8|

따라서 답은 X5 mod g = 8 mod 3 = 2이다.<br/>


## 풀이
f(n + 1) = a x f(n) + c이고 f(1) = X0라 f를 정의하면 f는 다음과 같은 행렬식을 얻을 수 있다.<br/>

	a c  x  Xn = Xn+1
	0 1     1    1

해당 행렬식을 이용해 Xn을 log n에 찾았다. 다만 a, c가 10^18까지 올 수 있으므로 곱셈을 덧셈으로 따로 정의했다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/1160