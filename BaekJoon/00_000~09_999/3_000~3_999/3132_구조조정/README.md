# C#

## 난이도 : 골드 4

## 알고리즘 분류
  - 그래프 이론
  - 정렬
  - 애드 혹

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 128 MB

## 문제
직원이 N명인 소프트웨어 회사가 있다. 사장을 제외한 모든 직원은 상사를 가지고 있다. 사장의 직속 부하는 적어도 한 명이다. 또, 상사 구조가 사이클을 이루는 경우는 없다. 즉, 이 회사의 상사 구조는 트리와 같은 모양이다.<br/>
직원 E의 워크그룹이란 E와 그가 상사인 모든 직원으로 이루어져 있다. 이때, E를 그 워크그룹의 상사라고 한다.<br/>
각 직원의 지능 지수(IQ)는 자연수로 나타낼 수 있다.<br/>
이 회사의 사장은 효율성을 증가시키기 위해서 상사 구조를 변화시키려고 한다. 새로운 구조는 아래와 같은 세 가지 조건을 만족해야 한다.<br/>

  1. 워크그룹의 멤버의 수는 3명을 넘으면 안 된다.
  2. 각 워크그룹의 상사보다 높은 지능 지수를 가진 멤버의 수는 한 명을 넘을 수 없다.
  3. 각 직원과 새 상사는 이전 구조에서 같은 워크그룹에 속해있는 사람이어야 한다.

위의 그림은 이 회사의 초기 구조이다. 트리의 각 노드에는 직원 번호와 그 직원의 IQ가 적혀져 있다. 이 구조에는 멤버의 수가 4인 워크그룹이 두 개나 존재하기 때문에, 문제의 조건을 만족시키지 않는다. 또, 직원 1과 8의 워크그룹은 조건 2를 위반한다.<br/>
따라서 위의 그림과 같이 구조를 바꿀 수 있다. 위의 구조는 세 가지 조건을 모두 만족시키는 구조의 예이다.<br/>
회사의 현재 구조가 주어졌을 때, 문제의 조건을 만족시키는 새로운 구조를 만드는 프로그램을 작성하시오.<br/>
항상 답이 존재하는 경우만 입력으로 주어진다. 하지만, 새로운 구조의 수가 여러 가지일 수도 있다.<br/>


## 입력
첫째 줄에 직원의 수 N이 주어진다. (2 ≤ N ≤ 1,000)<br/>
둘째 줄에는 각 직원의 지능지수가 직원 번호가 증가하는 순서대로 주어진다. 직원 번호는 1번부터 N번까지이며, IQ는 50보다 크거나 같고, 200보다 작거나 같은 자연수이다.<br/>
다음 N-1개의 줄에는 두 자연수 M과 E가 주어진다. (1 ≤ M ≤ N, 1 ≤ E ≤ N) 이 뜻은 원래 구조에서 M이 E의 상사라는 의미이다. <br/>


## 출력
출력은 총 N-1줄이다.<br/>
각 줄에는 M과 E를 출력하며, 새 구조에서 M이 E의 상사라는 의미이다. <br/>


## 예제 입력
4<br/>
140 120 160 130<br/>
1 2<br/>
1 3<br/>
1 4<br/>


## 예제 출력
1 2<br/>
1 3<br/>
2 4<br/>


## 풀이
트리로 주어지기에 어떤 두 노드 A, B를 잡아도 A에서 B로 가는 길은 유일하다.<br/>
그래서 리프(자식이 없는 노드)의 부모 P에서 규칙을 찾아갔다.<br/>
P의 자식이 3개, 4개 있는 경우면 2개로 줄이고, 자신보다 높은 사람을 1개로 줄여야 한다.<br/>
이에 이진 트리로 만드는 방법을 이용했다.<br/>
왼쪽에는 자기보다 IQ가 큰 사람을 오른쪽에서는 자기보다 작은 것 중 IQ가 가장 큰 것을 잡는다.<br/>
해당 방법으로하면 순서에 지장있어 보인다. 그래서 한 줄로 이어 해결했다.<br/>
P의 부모에도 이상없이 만족하면 수학적 귀납법으로 가능하다 판단했다.<br/>
그래서 해당 방법으로 관계를 재정립해갔다.<br/>
해당 규칙을 전체에 적용할 시 순서는 상관없어지므로 for문으로 해결했다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/3132