# C#

## 난이도 : 골드 5

## 알고리즘 분류
  - 수학
  - 애드 혹

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 128 MB

## 문제
p는 2보다 큰 정수이다. 다음과 같은 규칙으로 무한 이진 트리의 각 노드에 정수인 숫자가 매겨진다.<br/>

  - 루트 노드에는 1을 매긴다.
  - 노드에 x가 매겨져 있다면 해당 노드의 왼쪽 자식 노드에는 p * x, 오른쪽 자식 노드에는 p * x + 1이 매겨진다.

예를 들어 p = 3 일때 트리의 시작 부분은 다음과 같을 것이다.<br/>
어떤 숫자는 무한 이진 트리 내의 서로 다른 두 노드에 매겨진 두 숫자의 합으로 표현 할 수 있는 방법이 한 가지면 "예쁜 숫자"로 분류된다. 주어진 p로 만든 무한 이진 트리 내에서  n1, n2, n3, n4가 "예쁜"지 출력하는 프로그램을 작성하라.<br/>


## 입력
한 줄에 정수 p, n1, n2, n3, n4가 차례로 주어진다. (2 < p < 50, 0 < n1 < 10^18, 0 < n2 < 10^18, 0 < n3 < 10^18, 0 < n4 < 10^18)<br/>


## 출력
한 줄에 차례로 n1, n2, n3, n4가 예쁘면 1을, 아니면 0을 출력한다.<br/>


## 예제 입력
3 7 28 13 9<br/>


## 예제 출력
1 1 0 0<br/>


## 풀이
각 노드의 값은 ∑p^a_i 같은 형태로 표현된다.<br/>
​여기서 a_i는 서로 다른 음이 아닌 정수이다. 즉, 각 노드는 p의 거듭제곱들의 집합으로 구성된다.<br/>
따라서 두 노드 A, B의 합도 다음과 같이 표현할 수 있다.<br/>
A+B=∑b_i x p^i 단, b_i ∈ {0, 1, 2}<br/>


b_i의 의미를 확인하면 다음과 같다.<br/>

  - b_i = 2: A와 B 모두 p^i를 포함
  - b_i = 1: A 또는 B 중 한쪽만 p^i를포함
  - b_i = 0: A와 B 모두 p^i 를 포함하지 않음


Case 1: b_i = 1인 항이 2개, b_j = 2인 항이 없는 경우<br/>
​합은 p^i0 + p^i1 형태이며, 이를 나누는 방법은 A = p^i0, B = p^i1 또는 반대의 경우뿐이며, 두 경우는 본질적으로 같으므로 분할은 유일하다.<br/>


Case 2: b_i = 1인 항이 1개, b_j = 2인 항이 하나 이상 존재하는 경우<br/>
b_j = 2인 항들은 A, B에 모두 포함되어야 한다.(공통 부분)<br/>
b_i = 1인 항은 A 또는 B 한쪽에만 포함되어야 한다.<br/>
그래서 A = ∑p^j + p^i, B = ∑p^j 이거나 A = ∑p^j, B = ∑p^j + p^i 뿐이고 두 경우는 본질적으로 같으므로 분할은 유일하다.<br/>


Case 3: b_i = 1인 항이 2개, b_j = 2인 항이 하나 이상 존재하는 경우<br/>
b_i = 1인 항들을 모두 A에 포함하면 A = p^i0 + p^i1 + ∑p^j, B = ∑p^j이다.<br/>
b_i = 1을 각각 나눠서 A = p^i0 + ∑p^j, B = p^i1 + ∑p^j로 만들 수 있다.<br/>
서로 다른 두 분할이 존재하므로 유일하지 않다.<br/>


Case 4: b_i = 1인 항이 3개 이상인 경우
b_i = 1인 항 서로 다른 3개항을 i0, i1, i2라하자.<br/>
A = p^i0, B = p^i1 + p^i2를 할당하자.<br/>
A = p^i0 + p^i1, B = p^i2를 할당하자.<br/>
나머지 항의 분배와 관계없이 서로 다른 분할이 존재하고, 서로 다른 분할이 존재하므로 유일하지 않다.<br/>


두 노드의 합이 주어졌을 때 이를 유이라헥 분할할 수 있는 경우는 Case1과 Case2뿐이고 이외의 경우는 여러 가지 분할이 가능하다.<br/>
이제 기존 수 n을 ∑b_i x p^i 형태로 분해하기만 하면 위 경우를 확인해 결론을 내릴 수 있다.<br/>
n0 = n, ni = n(i-1) // p라 하자.<br/>
그러면 b_i = ni % p연산을 통해 밑이 p인 log n번 연산으로 모든 b_i를 찾을 수 있다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/3152