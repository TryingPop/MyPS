# C#

## 난이도 : 골드 3

## 알고리즘 분류
  - 그래프 이론
  - 최소 스패닝 트리

## 제한조건
  - 시간 제한 : 2초
  - 메모리 제한 : 64 MB

## 문제
어떤 나라에는 1부터 N까지 이름 붙여진 N개의 도시가 있다. 한 엔지니어는 모든 도시를 연결하는 도로를 건설하고자 한다. 즉, 모든 도시에 대해 항상 다른 어떤 도시로든 이동할 수 있어야 한다. 이때 여러 개의 도시를 통과할 수도 있다. 그의 팀은 몇 개의 길(도로 후보)을 조사했다. 각각의 길은 두 도시를 양방향으로 잇는다. 길 위에 도로를 지을 때는 특정 비용이 든다. (길이 짧을수록 비용도 싸다.)<br/>
이 엔지니어는 교통 시스템을 미리 계획하지 않았다. 그는 그저 선호에 따라 한 개의 길을 선택하고, 도로를 건설하는 일을 모든 도시가 연결될 때까지 반복한다.<br/>
지금 엔지니어는 도시 p와 도시 q를 잇는 도로를 건설하고자 한다. 비용을 감축하라는 정부의 압력에 의해, 그는 당신에게 그가 해당 도로를 지어야 하는지 여부를 판단하는 프로그램을 작성할 것을 요구했다. 당신의 프로그램은 그 도로를 지으면서 모든 도시를 연결하는 가장 짧은 도로망을 만들 수 있으면 YES라고 대답해야 한다. 그렇지 않다면, NO를 출력해야 한다.<br/>


## 입력
첫 줄에 테스트 케이스의 개수 T가 주어진다. (T ≤ 10)<br/>
각 테스트 케이스의 첫 줄에는 4개의 정수 N, M, p, q가 주어진다. N(2 ≤ N ≤ 10,000)은 도로망 위에 존재하는 도시의 수이다. M(1 ≤ M ≤ 20,000)은 길의 수이다. p와 q(1 ≤ p,q ≤ N)는 그 사이에 도로를 지어도 되는지 판단해야 하는 두 도시이다.<br/>
이어지는 M개의 줄 각각에는 u, v, w가 주어진다.(1 ≤ u ≤ N, 1 ≤ v ≤ N, 1 ≤ w ≤ 400,000) 도시 u와 v를 잇는 양방향 길의 비용이 w라는 것을 의미한다. 도로를 짓는 데 드는 비용은 모두 다르며, 두 도시를 잇는 길은 오직 하나이다. 모든 도시를 잇는 도로망이 최소 한 개 이상 존재한다는 것이 보장된다. 모든 입력은 정수이다.<br/>


## 출력
각 테스트 케이스에 대해, p-q를 지으면서 가장 짧은 도로망을 만들 수 있으면 YES를 출력한다. 아니면 NO를 출력한다.<br/>


## 예제 입력
3<br/>
2 1 1 2<br/>
1 2 4<br/>
3 3 2 3<br/>
1 2 1<br/>
1 3 2<br/>
2 3 3<br/>
4 5 3 4<br/>
1 2 1<br/>
1 3 3<br/>
3 4 2<br/>
1 4 4<br/>
4 2 5<br/>


## 예제 출력
YES<br/>
NO<br/>
YES<br/>


## 풀이
모든 도시가 연결될 때까지 도로를 건설한다. 그리고 도로를 지을 때는 비용이 싸게 짓는다.<br/>
이는 도로를 지을 때 최소신장 트리가 되게 짓는 것이다.<br/>


문제 조건에서 도시 p와 도시 q를 잇는 도로를 사용해 최소신장 트리를 만들 수 있는지 확인해야 한다.<br/>
먼저 크루스칼 알고리즘을 이용해 최소신장 트리를 만들어 최소 비용 mst을 찾는다.<br/>


다음으로 이제 p에서 q로 가는 도로 중 가장 싼 것을 지어 p와 q를 연결한다.<br/>
이후 나머지 도로에 대해 크루스칼 알고리즘처럼 나머지 노드에 대해 연결하며 비용 chk를 찾는다.<br/>


만들어진 그래프가 트리가 아니라고 하자.<br/>
그러면 적절한 a 노드와 b노드가 존재해 a에서 b로 우회해 가는 도로가 없다와 같다.<br/>
이는 문제 조건에서 모든 도시를 잇는 도로망이 최소 한 개 이상 존재하는 사실에 모순이다.<br/>


이제 사이클이 없음을 보이자.<br/>
크루스칼 알고리즘 방법으로 그래프를 만들었으므로 이어진 경우 간선을 잇지 않는다.<br/>
그래서 사이클은 없다고 단정지을 수 있다.<br/>


그래서 chk 비용이 드는 그래프는 트리이다.<br/>


이제 mst = chk인 경우 그래프는 트리이고, 최소 비용 mst로 만들어졌으므로 최소 신장 트리의 한 형태라 할 수 있다.<br/>
chk는 p와 q를 잇는 도로가 포함되어 있다.<br/> 
그래서 p - q를 지으면서 가장 짧은 도로망을 만든 것과 같아 YES를 출력한다.<br/>


반면 mst < chk인 경우 chk 비용은 p와 q를 잇는 도로를 사용해 만든 가장 비용이 적은 트리임을 그리디로 알 수 있다.<br/>
그래서 p-q를 포함 트리는 절대 MST가 될 수 없다와 같다.<br/>


이렇게 각 케이스에대해 p와 q를 잇는 도로를 건설하며 가장 짧은 도로망을 만들 수 있는지 판별했다.<br/>


반면 크루스칼 알고리즘에서 정렬 기준을 변형해 1번에 찾을 수 있다.<br/>
정렬 기준으로 비용으로 한다. 비용이 같은 경우 p와 q를 잇는 간선을 먼저 확인하게 해서 p - q 간선이 사용되었는지 기록한 뒤 판별해도 된다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/9344