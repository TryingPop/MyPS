# C#

## 난이도 : 골드 3

## 알고리즘 분류
  - 그리디 알고리즘
  - 애드 혹
  - 해 구성하기
  - 많은 조건 분기

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 512 MB

## 문제
당신은 어느 대도시에 교통 시스템을 구축하는 과제를 받았다. 이 대도시는 N개의 마을로 구성되어 있고, 각 마을의 번호는 1부터 N까지이다.<br/>
이 대도시는 막 완공되어 현재 마을 사이에 어느 도로도 건설되어 있지 않다. 당신은 양방향 도로를 원하는 만큼 건설해 모든 마을 간에 서로 이동이 가능하도록 대도시의 교통 시스템을 구축하려고 한다. 마을 번호가 a, b(a ≠ b)인 두 마을 사이를 잇는 양방향 도로를 건설하는 데 드는 비용은 a+b이다.<br/>
한편, 이 대도시에는 M개의 강이 있는데, 각 강은 두 마을 사이를 가로질러 흐르고 있다. 이로 인해 각 강을 가로지르는 두 마을 사이에는 양방향 도로를 건설할 수 없다.<br/>
당신에게 주어진 예산은 많지 않기 때문에 최소한의 비용으로 모든 마을이 서로 이동 가능하게 만들어야 한다. 최소 건설 비용이 얼마인지 구해보자.<br/>


## 입력
첫째 줄에 대도시를 구성하는 마을 개수 N과 두 마을 사이를 가로지르는 강의 개수 M이 공백으로 구분되어 주어진다.(4 ≤ N ≤ 10^9; 0 ≤ M ≤ 2)<br/>
둘째 줄부터 M개의 줄에 걸쳐 강을 가로지르는 두 마을의 번호 a, b가 공백으로 구분되어 주어진다. (1 ≤ a < b ≤ N)<br/>
서로 다른 강이 같은 두 마을 사이를 가로지르는 경우는 없다.<br/>


## 출력
첫째 줄에 모든 마을 간에 서로 이동이 가능하도록 양방향 도로들을 건설하는 데 드는 최소 비용을 출력한다.<br/>


## 예제 입력
4 2<br/>
1 2<br/>
2 4<br/>


## 예제 출력
14<br/>


## 힌트
1번과 3번 마을 사이, 1번과 4번 마을 사이, 2번과 3번 마을 사이를 잇는 양방향 도로를 건설하면 최소 비용으로 모든 마을 간에 이동이 가능하다. 총 비용은 (1+3)+(1+4)+(2+3) = 14로, 이보다 적은 비용으로 조건을 만족할 수 없다.<br/>


## 풀이
강이 흐르는 곳을 제외한 곳에 도로를 설치해 최소 신장 트리를 만드는 비용을 찾는 문제다.<br/>
강의 갯수가 2개 이하이므로 강의 갯수로 경우의 수를 나눠서 보면 다음과 같다.<br/>

  - 강이 없는 경우
  - 강이 1개 있는 경우
  - 강이 2개 있는 경우


① 강이 없는 경우는 1번과 연결된 경우로 만든다.<br/>
크루스칼 알고리즘을 보면 가장 비용이 싼 도로를 지어가며 마을을 유니온한다.<br/>
해당 아이디어로부터 1번과 도로를 지을 수 있다면 짓는게 최소임을 그리디로 알 수 있다.<br/>
그래서 해당 경우를 기준으로 하고 나머지 경우는 비용이 얼마나 추가되었는지로 확인한다.<br/>


② 강이 1개 있는 경우면 강이 흐르는 두 마을을 a < b로 a, b 마을 사이라 하자.<br/>
a = 1인 경우를 보면 b인 경우만 1번과 이을 수 없다.<br/>
다음과 같이 2가지 경우를 나눠서 본다.<br/>

  - a ≠ 1인 경우
  - a = 1이고 b = 2인 경우
  - a = 1이고 b ≠ 2인 경우


⑴ a ≠ 1인 경우 아닌 경우 강이 없는 것과 같고 모두 1번과 도로를 놓으면서 유니온한다.<br/>
이는 ①의 경우와 같고, 추가양은 0이다.<br/>


⑵ a = 1이고 b = 2인 경우 b를 최소와 이어주는데 최소는 3이다.<br/>
이는 1 - b와 이엇을 때보다 2 증가했다.<br/>
그래서 ①의 값에 + 2한 값이 된다.<br/>


⑶ 이제 a = 1이고 b ≠ 2인 경우 b를 최소와 이어주는데 최소는 2이다.<br/>
이는 1 - b과 이었을 때보다 1 증가했다.<br/>
그래서 ①의 값에 + 1한 값이 된다.<br/>


③ 강이 2개인 경우를 본다.<br/>
강 i에 대해 두 노드 사이를 지나는 노드를 ai < bi라 하자.<br/>
서로 다른 강이 같은 두 마을 사이를 가로지르는 경우는 없다했으므로 a1 = a2이고 b1 = b2인 경우는 없다.<br/>
편의상 a1 ≤ a2로 하고, 만약 a1 = a2이면 b1 < b2라 하자.<br/>


그리고 다음과 같이 경우를 나눠서 생각하자.

  - a1 ≥ 2인 경우
  - a1 = 1, a2 > 2이고 b1 = 2인 경우
  - a1 = 1, a2 > 2이고 b1 ≠ 2인 경우
  - a1 = a2 = 1이고 b1 = 2, b2 = 3인 경우
  - a1 = a2 = 1이고 b1 = 2, b2 > 3인 경우
  - a1 = a2 = 1이고 b1 > 2인 경우
  - a1 = 1이고 a2 = 2이고 b1 = b2 = 3인 경우
  - a1 = 1이고 a2 = 2이고 b1 = b2 ≠ 3인 경우
  - a1 = 1, a2 = b1 = 2, b2 = 3인 경우
  - 이외 경우 (a1 = 1, a2 = 2이고 b1 ≠ b2인 경우)


⑴ a1 ≥ 2인 경우 모든 노드에 대해 1번과 연결해주는 것이 가능하다.<br/>
그래서 강이 없는 경우와 연산이 같고 증가한 값은 0이다.<br/>
그래서 ①의 값과 같다.<br/>


⑵ a1 = 1, a2 > 2이고 b1 = 2인 경우를 본다.<br/>
b1 = 2의 경우는 3번과 잇는다. 해당 경우 1 - b1에서 값이 2 증가한다.<br/>
b2 ≠ b1인 경우 b2는 그냥 1번과 이을 수 있어 증가량은 0이다.<br/>
b2 = b1인 경우 앞에서 해결했다.<br/>
그래서 ①의 경우에서 2만 증가한다.<br/>


⑶ a1 = 1, a2 > 2이고 b1 ≠ 2인 경우를 본다.<br/>
b1의 경우는 2번과 잇는다. 해당 경우 1 - b1에서 값이 1 증가한다.<br/>
b2 ≠ b1인 경우 b2는 그냥 1번과 이을 수 있어 증가량은 0이다.<br/>
b2 = b1인 경우 앞에서 해결했다.<br/>
그래서 ①의 경우에서 1만 증가한다.<br/>

⑷ a1 = a2 = 1이고 b1 = 2, b2 = 3인 경우를 보자.<br/>
2는 1로 이을 수 없다. 2와 잇는 가장 작은 값은 3이다. 여기서 1 - 2 보다 2증가한다.<br/>


이제 3에 대해서 다른 노드와 잇는데, 가장 작은 값은 4이다. 이 때 1 - 3보다 3 증가한다.<br/>
그런데 2 와 3이 이어져있으므로 2에서 4와 잇는 경우 2 증가하므로 2에서 4로 잇는 것이 최소이다.<br/>


그래서 최소로 이어주면 ①에서 증가량은 4이다.<br/>


⑸ a1 = a2 = 1이고 b1 = 2, b2 > 3인 경우를 보자.<br/>
2는 1로 이을 수 없다. 2와 잇는 가장 작은 값은 3이다. 여기서 1 - 2 보다 2증가한다.<br/>


이제 b2 > 3인 경우를 보면 2번과 이어주는게 최소이고 1 - b2와 잇는거보다 1 증가한다.<br/>
2는 3과 이어져 있고 3은 1과 이어져 있으므로 최소로 이어준 것이다.<br/>
그리고 이 때 ①의 경우보다 3이 증가했다.<br/>


⑹ a1 = a2 = 1이고 b1 > 2인 경우를 보자.<br/>
2는 1과 이을 수 있어 1과 이어져 있다.<br/>
그리고 b1, b2는 모두 1과 이을 수 없고 2와 이어준다. 그러면 증가량은 각각 1이다.<br/>
그래서 ①의 경우보다 2증가했다.<br/>


⑺ a1 = 1이고 a2 = 2이고 b1 = b2 = 3인 경우를 보자.<br/>
3번의 경우 1, 2번과 이을 수 없다. 가장 작은 값과 잇는다면 4와 잇는 것이다.<br/>
그리고 이 경우 1 - 3와 이을 때보다 3이 증가했다.<br/>
그래서 ①의 경우보다 3이 증가했다.<br/>


⑻ a1 = 1이고 a2 = 2이고 b1 = b2 ≠ 3인 경우를 보자.<br/>
b1의 경우 잇는다면 1, 2번과 이을 수 없고 가장 작은 3번과 잇는게 최소이다.<br/>
그리고 이 경우 1 - b1과 이을 때보다 2가 증가했다.<br/>
그래서 ①의 경우보다 2이 증가했다.<br/>


⑼ a1 = 1, a2 = b1 = 2, b2 = 3인 경우를 보자.<br/>
2의 경우 1, 3번과 이을 수 없고 가장 작은 4번과 잇는게 최소이다.<br/>
마을의 수는 4 이상이므로 언제나 4번과 이을 수 있다.<br/>
그리고 이 경우 1 - 2보다 3증가했다.<br/>
그리고 나머지의 경우 1번과 이을 수 있다.<br/>
그래서 ①의 경우보다 3이 증가했다.<br/>


⑽ 이외 경우를 보자.<br/>
a1 = 1, a2 = 2이고 b1 ≠ b2인 경우 뿐이다.<br/>
이는 b2의 경우 1과 이을 수 있고 강을 무시하는 것과 같다.<br/>
그래서 ②의 경우로 풀면 된다.<br/>


이렇게 경우의 수를 나눠서 풀었다.<br/>
해당 방법의 경우 모두 사칙연산이고 각 경우 모두 O(1)에 해결이 된다.<br/>
그래서 시간 복잡도는 O(1)이다.<br/>


이를 표로 분석하면 다음과 같다.<br/>


|강의 갯수|a, b 조건|비용 증가량|비고|
|:---:|:---:|:---:|:---:|
|0|없음|0|기본 MST|
|1|a ≠ 1|0|MST와 동일|
|1|a = 1, b = 2|+2|2 → 3 연결|
|1|a = 1, b ≠ 2|+1|b → 2 연결|
|2|a1 ≥ 2|0|MST 가능|
|2|a1 = 1, a2 > 2|b1 = 2인 경우 +2<br/>b1 ≠ 2인 경우 +1|b2 → 1로 강이 없는것과 같다.<br/>b1은 강이 1개 경우와 똑같이 해결|
|2|a1 = a2 = 1, b1 = b2 = 3|+4|2 → 3, 3 → 4 연결|
|2|a1 = a2 = 1, b1 = b2 > 3|+3|2 → 3, b2 → 2 연결|
|2|a1 = a2 = 1, b1 > 2|+2|b1 → 2, b2 → 2 연결|
|2|a1 = 1, a2 = 2, b1 = b2 = 3|+3|3 → 4 연결|
|2|a1 = 1, a2 = 2, b1 = b2 ≠ 3|+2|b1 → 3 연결|
|2|a1 = 1, a2 = b1 = 2, b2 = 3|+3|2 → 3, 2 → 4 연결|
|2|a1 = 1, a2 = 2, b1 ≠ b2|b1 = 2인 경우 +2<br/>b1 ≠ 2인 경우 +1|b1 = 2인 경우 b1 → 3연결<br/>b1 ≠ 2인 경우 b1 = 2연결<br/>b2 → 1연결|


## 문제 링크
https://www.acmicpc.net/problem/34016