# C#

## 난이도 : 플레티넘 1

## 알고리즘 분류
  - 자료 구조
  - 트리
  - 세그먼트 트리
  - 누적 합
  - 느리게 갱신되는 세그먼트 트리
  - 최소 공통 조상
  - heavy-light 분할

## 제한조건
  - 시간 제한 : 2초
  - 메모리 제한 : 1024 MB

## 문제
당신은 shake! 대회의 네트워크 관리자다. 모든 네트워크의 사용은 예약 큐에 등록 후 당신의 승인을 받아 이루어진다.<br/>
놀랍게도 네트워크는 트리 구조의 그래프이다. 네트워크의 각 정점은 1번부터 N번까지 번호가 부여되어 있고, 모든 간선은 양방향이다.<br/>
각 예약은 x,y,w로 표현된다. 각 정점의 초기 대역폭 사용량은 0이며, 어떤 예약이 승인되면 x번 정점과 y번 정점을 잇는 최단 경로에 포함되는 모든 정점의 대역폭 사용량이 w만큼 증가한다. 이때 최단 경로는 양 끝의 x번 정점과 y번 정점을 포함한다.<br/>
그런데 각 정점은 한계 대역폭이 있어 대역폭을 과다하게 사용하면 전체 서버가 다운된다. 이것은 네트워크 관리자로서 용납할 수 없는 일이다. 즉, 어떤 정점의 대역폭 사용량도 그 정점의 한계 대역폭을 넘으면 안 된다. 또한 큐의 순서는 중요하기 때문에, 앞선 예약을 받지 않고 이후 예약을 승인할 수 없다. 예를 들어 1번, 2번, 3번 예약을 받거나 아무 예약도 받지 않을 수 있지만, 1번, 3번 예약만 받거나 2번, 3번 예약만 받을 수는 없다.<br/>
승인할 수 있는 최대 예약 수를 구해보자.<br/>


## 입력
첫째 줄에 네트워크의 정점 개수 N과 예약 개수 M이 공백으로 구분되어 주어진다. (2 ≤ N,M ≤ 100,000)<br/>
다음 N-1개의 줄에 네트워크의 각 간선이 잇는 두 정점의 번호 u, v가 공백으로 구분되어 주어진다. (1 ≤ u,v ≤ N; u ≠ v)<br/>
다음 줄에 N개의 정수 A_1, A_2, ...,A_N이 공백으로 구분되어 주어지며, 이때 A_i는 i번 정점의 한계 대역폭이다. (0 ≤ A_i ≤ 10^9)<br/>
다음 M개의 줄에 각 예약을 표현하는 정수 x, y, w가 공백으로 구분되어 큐에 등록된 순서대로 주어진다. 이는 예약을 승인하면 x번 정점과 y번 정점을 잇는 최단 경로에 포함되는 모든 정점의 대역폭 사용량이 w만큼 증가하는 것을 의미한다. (1 ≤ w ≤ 10^9; 1 ≤ x,y ≤ N)<br/>
입력으로 주어지는 네트워크는 트리 구조이다.<br/>


## 출력
승인할 수 있는 최대 예약 수를 하나의 정수로 출력한다.<br/>


## 예제 입력
3 2<br/>
1 2<br/>
2 3<br/>
5 5 5<br/>
2 1 5<br/>
3 2 5<br/>


## 예제 출력
1<br/>


## 풀이
트리 그래프가 주어진다.<br/>
그리고 쿼리가 트리안의 노드의 범위에 값을 대역폭을 누적하며 관리하게 된다.<br/>
그래서 HLD 알고리즘을 써서 트리의 노드 범위를 다루었다.<br/>


대역폭 상한이 주어지는데, 이는 구간에서 남은 부분을 관리하는 식으로 대역폭이 추가된 만큼 값을 빼줬다.<br/>
그리고 임의 하나의 대역폭이 과다한 경우 전체 서버가 다운되기에 세그먼트 트리에 최솟값이 음수인지 확인하는 식으로 서버가 다운된게 있는지 확인했다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/31234