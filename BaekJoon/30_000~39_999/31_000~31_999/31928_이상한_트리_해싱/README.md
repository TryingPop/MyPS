# C#

## 난이도 : 골드 4

## 알고리즘 분류
  - 애드 혹
  - 해 구성하기

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 1024 MB

## 문제
트리를 해싱한다면 두 트리가 동형인지 빠르게 확인할 수 있지 않을까?<br/>
루트 정점이 존재하는 트리가 있을 때, 트리의 각 정점 K의 해시값 H(K)는 K의 자식 정점 P_1, P_2, ..., P_r의 해시값 H(P_1), H(P_2), ..., H(P_r)을 사용하여 다음과 같이 계산된다.<br/>

  - H(K) = 2^(H(P_1)H(P_2) ... H(P_r)) 

이때, 리프 정점의 해시값은 2이다.<br/>
양의 정수 h가 주어질 때, 루트 정점의 해시값이 h이고 서로 동형이 아닌 두 트리 T_1, T_2를 출력하라.<br/>


## 입력
첫 번째 줄에 루트 정점이 가져야 할 해시값 h가 주어진다. (1 ≤ h ≤ 10^18)<br/>


## 출력
첫 번째 줄에 T_1과 T_2의 크기 n, m을 공백으로 분리하여 출력한다. (1 ≤ n, m ≤ 100,000)<br/>
두 번째 줄에 T_1의 2번 정점부터 n번 정점까지 각 정점의 부모 정점의 번호 p_2, p_3, ..., p_n$을 공백으로 분리하여 출력한다. (1 ≤ p_i < i)<br/>
세 번째 줄에 T_2의 2번 정점부터 m번 정점까지 각 정점의 부모 정점의 번호 q_2, q_3, ..., q_m을 공백으로 분리하여 출력한다. (1 ≤ q_i < i$)<br/>
1번 정점은 루트 정점이다.<br/>
서로 동형이 아닌 트리가 여러 쌍 있다면, 그 중 하나를 출력한다.<br/>
만약 조건을 만족하는 두 트리가 존재하지 않는다면 첫 번째 줄에 -1을 출력한다.<br/>


## 예제 입력
16<br/>

## 예제 출력
3 3<br/>
1 2<br/>
1 1<br/>


## 노트
두 루트 있는 트리 G, H가 동형이라는 것은 G의 임의의 두 정점 u, v가 주어졌을 때 G에서 u가 v의 부모인 것과 H에서 f(u)가 f(v)의 부모인 것이 필요충분조건인 일대일 함수 f:V(G) → V(H)가 존재한다는 것이다. 여기에서 V(G)와 V(H)는 각각 G와 H의 정점 집합을 의미한다.<br/>


## 풀이
해싱 연산을 보면 H(K) = 2^(2^k), k > 1인 경우만 해가 존재함을 알 수 있다.<br/>
그리고 크기 3인 트리를 보면 루트의 자식이 2개인 경우와 루트의 자식이 1개인 경우 해시 값이 같음을 알 수 있다.<br/>
여기서 양 그래프에 루트에 자식을 1개씩 추가해도 해시 값이 같음을 확인할 수 있다.<br/>
이 사실을 이용해 정답을 찾았다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/31928