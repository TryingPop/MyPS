# C#

## 난이도 : 골드 4

## 알고리즘 분류
  - 그래프 이론
  - 그래프 탐색
  - 트리

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 1024 MB

## 문제
루매는 모든 종류의 트리를 좋아하지만, 그 중에서도 특별히 더 좋아하는 트리가 있다. 루매는 특별히 좋아하는 트리를 '풍성한 트리'라고 정의내렸다. 다음 조건을 만족하는 트리를 '풍성한 트리'라고 한다.<br/>

  - 모든 노드의 차수는 1 또는 3이다. 단, 루트 노드의 차수는 3이다.
  - 루트 노드와 차수가 1인 모든 노드간의 거리는 모두 같다.

이 때 두 노드 사이의 거리는 두 노드를 연결하는 단순 경로의 간선 개수로 정의된다. 호기심 많은 루매는 주어진 트리가 '풍성한 트리'인지 여부를 알고 싶다. 또한, 루매는 풍성한 트리의 꼭대기에 앉는 걸 좋아하기에 주어진 트리가 '풍성한 트리' 라면 어떤 노드가 루트 노드가 될 수 있는지 알고 싶다.<br/>


## 입력
첫 번째 줄에 트리의 노드 개수 N이 주어진다. (4 ≤ N ≤ 200,000)<br/>
두 번째 줄부터 N-1개의 줄에 걸쳐 노드 a, b가 공백으로 구분되어 주어진다. (1 ≤ a,b ≤ N) 노드 a와 노드 b는 간선으로 이어져 있다.<br/>
주어진 입력은 트리임이 보장된다.<br/>


## 출력
주어진 트리가 '풍성한 트리'가 될 수 있다면 첫 번째 줄에 루트 노드가 될 수 있는 노드의 개수를 출력한다. 두 번째 줄에 루트 노드가 될 수 있는 노드를 오름차순으로 공백으로 구분해 모두 출력한다.<br/>
만약 주어진 트리가 '풍성한 트리'가 될 수 없다면 -1을 출력한다.<br/>


## 예제 입력
4<br/>
1 2<br/>
1 3<br/>
1 4<br/>


## 예제 출력
1<br/>
1<br/>


## 풀이
그래프가 트리임이 보장되기에 따로 트리인지 확인할 필요는 없다.<br/>
만약 보장이 안된다면 크루스칼 알고리즘으로 트리인지 확인했을 것이다.<br/>
그래서 주어진 그래프가 트리라고 확정하고 진행했다.<br/>


문제에서 말하는 차수는 해당 노드와 이어진 간선의 갯수를 말한다.<br/>
문제 조건으로 차수가 1인 노드는 리프노드임이 자명하다.<br/>
조건에 맞게 풍성한 트리 그래프 형태를 몇 개 그려보면 모두 리프가 루트와 거리가 같고, 풍성한 트리의 루트만 자식이 3개이고 루트와 리프가 아닌 모든 노드는 자식이 모두 2개이다.<br/>
여기서 아무 차수가 3인 노드 A를 루트로 선택해 새롭게 그래프 형태를 변형하자.<br/>
문제 조건과 트리이므로 차수가 1인 노드는 리프임이 자명하고, 리프는 3개 이상 존재함이 보장된다.<br/>
그러면 노드 A와 거리가 가장 짧은 리프 노드 m과, 노드 A와 가장 거리가 긴 리프노드 M에 대해 풍성한 트리의 루트는 m과 M의 중심임을 알 수 있다.<br/>


먼저 노드들에 이어진 간선의 갯수가 1 또는 3으로만 이루지고 루트는 3만 가능하므로 3이 적어도 1개 있는지 확인한다.<br/>
여기서 1, 3이 아닌 다른 차수가 존재하거나 차수가 3이 하나도 존재하지 않는다면 불가능하다고 판별한다.<br/>


앞에서 찾은 차수가 3인 노드를 루트로 그래프를 설정한다.<br/>
이제 루트와 가장 멀리 떨어진 리프랑, 가장 가까운 리프를 찾아야 한다.<br/>


두 노드 사이의 거리를 확인하기 위해 LCA알고리즘을 이용했다.<br/>
그래서 LCA에 필요한 DFS로 부모를 설정하고 리프노드를 모두 찾는다.<br/>
찾은 각 리프에 대해 루트와 거리를 확인해 최대와 최소를 찾는다.<br/>
여기서 리프의 깊이가 5 이상인 경우 서로 다른 거리는 3개 이상 존재함을 알 수 있다. 이부분을 캐치 못해 여러 번 틀렸다.<br/>


이후 최대 거리를 갖는 리프에서 ((루트와 리프의 최대 거리) + (루트와 리프의 최소 거리)) / 2만큼 루트로 이동한다.<br/>
마지막으로 해당 노드가 풍성한 노드의 루트가 되는지 확인해 제출하니 통과했다.<br/>
이렇게 제출하니 240ms 안에 풀린다.<br/>


케이스가 약하고, C# 언어의 추가시간으로 모든 차수가 3인 노드에 대해 리프까지의 거리가 같은지 확인해도 시간초과 없이 통과하기도 한다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/32934