# C#

## 난이도 : 플레티넘 4

## 알고리즘 분류
  - 다이나믹 프로그래밍
  - 그래프 이론
  - 그래프 탐색
  - 깊이 우선 탐색
  - 스위핑

## 제한조건
  - 시간 제한 : 2초
  - 메모리 제한 : 512 MB

## 문제
욱제는 🎄포화이진트리🎄를 종이에 그렸다. 노드에 정수 가중치도 채워 넣었다. 욱제는 적당한 직사각형 영역을 잡아서, 영역 내에 있는 노드들의 가중치 합을 최대로 하고 싶다. 직사각형은 하나 이상의 노드를 포함해야 하고 직사각형은 비뚤어지면 안 된다.<br/>
문제에서 생략된 정의는 다음과 같다. 이해가 안 되면 읽어보자.<br/>

  1. 직사각형은 축에 평행하며, 변이 노드에 걸치면 안 된다.
  2. 모든 노드 u에 대해, u의 왼쪽 서브 트리에 속하는 모든 노드의 x좌표는, u의 x좌표보다 작다.
  3. 모든 노드 u에 대해, u의 오른쪽 서브 트리에 속하는 모든 노드의 x좌표는, u의 x좌표보다 크다.
  4. 자식 노드의 y좌표는 부모 노드의 y좌표보다 작다.
  5. 트리에서의 깊이가 같은 노드의 y좌표는 모두 같다.


## 입력
첫째 줄에 노드 개수 N이 주어진다. (1 ≤ N ≤ 262,143, N은 2k-1 꼴의 자연수)<br/>
둘째 줄에 노드의 가중치 Wi가 노드 번호 순서대로 주어진다. (-10^9 ≤ Wi ≤ 10^9)<br/>
루트 노드의 번호는 1이고, i번 노드의 좌우 자식 노드의 번호는 각각 2×i, 2×i+1이다.<br/>


## 출력
욱제가 얻을 수 있는 가중치의 최대 합을 출력한다.<br/>


## 예제 입력
15<br/>
-2 8 -3 -9 0 -6 3 4 -1 10 -1 7 -100 7 -1<br/>


## 예제 출력
24<br/>


## 힌트
In this example, the path from 1 and 4 involves farms 1, 2, and 4. All of these contain cows of type 1, so the first friend will be satisfied while the second one will not.<br/>


## 풀이
먼저 트리를 문제 조건에 맞게 좌표를 배정한다.<br/>
그러면 높이의 범위는 log N이 된다.<br/>
이후 사각형의 위와 아래는 브루트포스로 모든 경우를 설정하면 가로범위만 확인하면 된다.<br/>
해당 부분은 kadane 알고리즘으로 해당 구간의 최대값을 O(N)으로 찾아가면 된다.<br/>
그러면 전체 시간복잡도는 O(N x log N x log N)이 된다.<br/>


kadane 알고리즘은 i까지 진행했을 때 누적된 최댓값이 된다.<br/>
그래서 dp[i] = val를 i번째까지 진행했을 때 최댓값 val를 저장한다.<br/>
점화식은 dp[i] = Math.Max(arr[i], arr[i] + dp[i - 1])이 된다.<br/>
해당 경우 아무것도 포함안할 수도 있어, 적어도 하나의 노드를 포함해야 한다면 초기값을 첫 원소를 포함하게 해줘야 한다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/18251