# C#

## 난이도 : 골드 4

## 알고리즘 분류
  - 그래프 이론
  - 최단 경로
  - 데이크스트라

## 제한조건
  - 시간 제한 : 5초
  - 메모리 제한 : 512 MB

## 문제
서로 다른 도시에 사는 친구들이 급히 약속장소를 정하려고 한다. 하지만 길이 너무 복잡하고 서로 멀리 살아서, 어느 정도 시간 여유를 잡아야 할지 알아내기가 어렵다. 친구들이 한 곳에서 만나는 데 걸리는 최소한의 시간은 얼마인가?<br/>
약속장소를 잡기 위해 펼친 지도에는 도시와 각 도시를 잇는 도로에 대한 정보가 있다. 이것은 두 도시를 연결하는 길을 의미하는 것이 아니라, 연속된 길들의 집합으로서 여러 도시를 지나간다.<br/>
더욱 자세히 말하면, 각각의 T 개의 테스트 케이스에 대해 다음과 같은 것이 주어진다.<br/>

  - N: 도시의 숫자
  - P: 친구의 수
  - M: 도로의 숫자

각 도시는 순서대로 1부터 N까지의 번호가 붙여져 있다.<br/>
또한, 1부터 P까지의 번호가 붙여져 있는 각 친구 i에 대해, 다음과 같은 것이 주어진다.<br/>

  - Xi: 친구가 출발하는 도시의 번호.
  - Vi: 친구가 거리 1 만큼 움직이는 데 걸리는 시간.

각 도시를 잇는 도로 j에 대해서는 다음과 같은 것이 주어진다. 도로는 단순히 두 도시를 잇는 길이 아니라, 여러 도시를 순서대로 잇는 연속된 길의 모임이다.<br/>

  - Dj: 도로가 지나가는 도시들 사이의 거리. (한 도로 위에서, 인접한 도시 사이의 거리는 Dj로 같다.)
  - Lj: 도로가 지나가는 도시들의 숫자
  - {Cj,k}: 도로가 이어주는 도시의 번호가 순서대로 나열된다.

위의 정보들을 이용해서, 동시에 출발한 친구들이 한 도시에서 만나는 데 필요한 최소한의 시간을 구하시오. 만약 다들 모일 수 있는 도시가 없다면 '-1'을 대신 출력하시오.<br/>
모임은 도시에서만 이루어질 수 있으며, 먼저 도착한 친구들은 다른 친구들을 기다릴 수 있다.<br/>
두 도시를 바로 연결하는 도로는 둘 이상 존재할 수 없으며, 어떤 도시에 도착하였을 때, 해당 도시를 지나는 도로 간의 이동은 추가 시간 없이 자유로이 할 수 있다.<br/>


## 입력
입력은 다음과 같은 형식으로 주어진다.<br/>


	T
	N P M
	X1 V1
	X2 V2
	...
	XP VP
	D1 L1 C1,1 C1,2 ... C1,L1
	D2 L2 C2,1 C2,2 ... C2,L2
	...
	DM LM CM,1 CM,2 ... CM,LM
	N' P' M'
	....


## 제한
  - 각 테스트 케이스에 대한 답은 2147483647 이하이다.
  - 1 ≤ T ≤ 30.
  - 1 ≤ Vi ≤ 200.
  - 1 ≤ Di ≤ 200.
  - 2 ≤ Lj ≤ N.
  - 1 ≤ N ≤ 10000.
  - 2 ≤ P ≤ 100.
  - 1 ≤ M ≤ 1000.
  - 2 ≤ Lj≤ 150.


## 출력
각각의 테스트 케이스에 대해서, x가 1번부터 시작하는 케이스 번호라고 하고 y가 각 케이스에 해당하는 답이라고 할 때 출력 파일의 각 줄에 "Case #x: y"와 같은 형식으로 출력한다. 친구들이 한 도시에서 만나는 것이 불가능하다면, 최소 시간 대신 '-1'을 출력한다.<br/>


## 예제 입력
3<br/>
2 2 1<br/>
1 1<br/>
2 2<br/>
1 2 1 2<br/>
5 2 2<br/>
1 1<br/>
5 100<br/>
1 3 1 2 3<br/>
2 3 4 2 5<br/>
5 2 2<br/>
1 1<br/>
5 5<br/>
1 2 1 2<br/>
1 3 3 4 5<br/>


## 예제 출력
Case #1: 1<br/>
Case #2: 3<br/>
Case #3: -1<br/>


## 풀이
간선의 갯수는 많아야 150 x 1000 = 15만개이다.<br/>
그리고 장소는 1만개 이다.<br/>
사람의 수는 100명을 넘지 않는다.<br/>


각 사람이 있는 위치마다 다익스트라를 실행하는 경우 100만 x log 15만이고 이는 2천만을 넘지 못한다.<br/>
그리고 테스트 케이스가 30개까지 있고 시간 제한은 5초이다.<br/>
C# 추가시간을 고려하면 할만하다 판단해 각 사람에 대해 다익스트라를 진행했다.<br/>


그리고 얻어진 거리 배열에 대해 각 지점을 목적지로 하고 모든 사람이 도착할 수 있는 경우에 한해 모든 사람이 도착하는 시간을 찾는다.<br/>
시간은 각 사람별로 속도 x 거리가  중 가장 큰 값이 모두 모이는 시간이 된다.<br/>


이렇게 모두 모이는 시간 중 가장 짧은 시간을 제출하니 이상없이 통과한다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/12442