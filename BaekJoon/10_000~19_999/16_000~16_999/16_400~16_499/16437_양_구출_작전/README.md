# C#

## 난이도 : 골드 3

## 알고리즘 분류
  - 그래프 이론
  - 그래프 탐색
  - 트리
  - 깊이 우선 탐색

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 256 MB

## 문제
N개의 섬으로 이루어진 나라가 있습니다. 섬들은 1번 섬부터 N번 섬까지 있습니다.<br/>
1번 섬에는 구명보트만 있고 다른 섬에는 양들 또는 늑대들이 살고 있습니다.<br/>
늘어나는 늑대의 개체 수를 감당할 수 없던 양들은 구명보트를 타고 늑대가 없는 나라로 이주하기로 했습니다.<br/>
각 섬에서 1번 섬으로 가는 경로는 유일하며 i번 섬에는 pi번 섬으로 가는 다리가 있습니다.<br/>
양들은 1번 섬으로 가는 경로로 이동하며 늑대들은 원래 있는 섬에서 움직이지 않고 섬으로 들어온 양들을 잡아먹습니다. 늑대는 날렵하기 때문에 섬에 들어온 양을 항상 잡을 수 있습니다. 그리고 늑대 한 마리는 최대 한 마리의 양만 잡아먹습니다.<br/>
얼마나 많은 양이 1번 섬에 도달할 수 있을까요?<br/>


## 입력
첫 번째 줄에 섬의 개수 N (2 ≤ N ≤ 123,456) 이 주어집니다.<br/>
두 번째 줄부터 N-1개에 줄에 2번 섬부터 N번 섬까지 섬의 정보를 나타내는 ti, ai, pi (1 ≤ ai ≤ 109, 1 ≤ pi ≤ N) 가 주어집니다.<br/>
ti가 'W' 인 경우 i번 섬에 늑대가 ai마리가 살고 있음을, ti가 'S'인 경우 i번 섬에 양이 ai마리가 살고 있음을 의미합니다. pi는 i번째 섬에서 pi번 섬으로 갈 수 있는 다리가 있음을 의미합니다.<br/>


## 출력
첫 번째 줄에 구출할 수 있는 양의 수를 출력합니다.<br/>


## 예제 입력
7<br/>
S 100 1<br/>
S 100 1<br/>
W 100 1<br/>
S 1000 2<br/>
W 1000 2<br/>
S 900 6<br/>


## 예제 출력
1200<br/>


## 풀이
섬을 노드, 다리를 간선이라 하면 주어지는 그래프는 트리이다.<br/>
각 노드에서 1번노드로 이동을 시도한다.<br/>


1번 노드를 루트 노드로 부모자식 관계를 재설정한다.<br/>
부모로 이동하는데 모든 자식이 자신으로 이동한 경우에 한해서 누적된 양을 이동 해도 결과는 같다.<br/>


예제를 보면 1 - 2 - 5로 2는 1의 자식이고 5는 2의 자식인 관계다.<br/>
또한 1 - 2 - 6 - 7 자식 관계다.<br/>


5번은 리프이고 5번에서 2번으로 이동한다.<br/>
2번은 6번 자식이 이동안했고 모든 자식이 이동안했으므로 이동할 수 없다.<br/>


그리고 7번도 리프이고 7번에서 6번으로 이동한다.<br/>
6번의 경우 유일한 자식 7번이 이동했으므로 모든 자식이 이동해 6번 이동을 시도한다.<br/>
그리고 2번의 모든 자식의 이동 시도를 했으므로 이제 2번이 1번으로 이동을 시도한다.<br/>


이렇게 노드 DFS로 이동을 확인하면 된다.<br/>


이제 이동의 경우를 확인하자.<br/>
현재 노드가 양인 경우 양의 값으로 양을 표현한다.<br/>
반면 늑대인 경우 음수 값으로 표현한다.<br/>


자식 노드에 있는 양의 갯수를 현재 노드에 누적하면 된다.<br/>
이렇게 누적했을 때 음수인 경우 양이 못 오므로 양은 0이다.<br/>
또한 늑대는 이동하지 않는다고 했으므로 0으로 한다.<br/>


이렇게 이동한 뒤 1번 노드에 양을 출력하면 된다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/16437