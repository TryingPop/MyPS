# C#

## 난이도 : 골드 4

## 알고리즘 분류
  - 자료 구조
  - 그리디 알고리즘
  - 우선순위 큐

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 512 MB

## 문제
안녕? 내 이름은 ntopia!<br/>
나는 원래 지구에 살고 있던 평범한 20대 청년이었어. 어느 날 길을 걷다가 괴한의 칼에 찔려 죽어버렸어. 그런데 이게 무슨 일이람! 정신을 차려보니 이세계에 떨어져 버렸지 뭐야. 여기에서 나는 슬라임을 전문으로 연구하는 슬라임 연구자가 되어버린 것 같아. 나는 지금 아주 중요한 연구를 진행하고 있어. 이 연구가 성공하면 나는 내가 살던 세계로 돌아갈 수 있게 될 거야. 이 연구를 도와주지 않겠니?<br/>
이곳의 슬라임은 모두 슬라임 에너지라는 것을 갖고 있고 그 양은 2 이상의 자연수로 표현돼. 나는 슬라임을 합성했을 때 슬라임 에너지가 어떻게 변화하는지에 대해 연구하고 있어.<br/>
슬라임 합성 과정은 2마리를 합성해서 1마리를 만들어내는 식으로 이루어져. A만큼의 슬라임 에너지를 가진 슬라임과 B만큼의 슬라임 에너지를 갖고 있는 슬라임이 있었다고 해보자. 이 슬라임 2마리를 합성하면 슬라임 에너지가 A × B 인 슬라임을 만들 수 있어.<br/>
그리고 슬라임 합성 기술이 아직 완벽하지 않아서 슬라임을 합성할 때마다 크나큰 전기 에너지가 필요해. 구체적으로, A만큼의 슬라임 에너지를 가진 슬라임과 B만큼의 슬라임 에너지를 가진 슬라임을 합성하려면 A × B 만큼의 전기 에너지가 필요해.<br/>
에너지가 4인 슬라임과 에너지가 6인 슬라임을 합성한 모습. 4 × 6의 전기 에너지를 사용해 슬라임 에너지가 24인 슬라임이 합성되었다.<br/>
나에겐 지금 N마리의 슬라임이 있어. 이 슬라임들을 모두 적절히 합성해서 1마리의 슬라임으로 만들려고 해. 그런데 내가 소속된 연구소에서 각 합성 단계마다 필요한 전기 에너지들을 모두 곱한 값을 나에게 비용으로 청구하겠다고 했지 뭐야. 그래서 이 값이 최소가 되도록 합성을 적절히 수행하는 것이 내 연구의 목표야.<br/>
내 연구를 도와줘! 부탁이야!!<br/>


## 입력
첫 번째 줄에 테스트 케이스의 수 T 가 주어지고, 이어서 T 개의 테스트 케이스가 주어진다.<br/>
각 테스트 케이스의 첫 번째 줄에는 슬라임의 수 N (1 ≤ N ≤ 60)이 주어지고, 두 번째 줄에는 N 개의 자연수가 주어진다. i번째 자연수 Ci (2 ≤ Ci ≤ 2 × 1018) 는 i번째 슬라임의 슬라임 에너지를 나타낸다. 끝까지 합성하고 난 후에 생기는 슬라임의 에너지의 양이 2 × 1018 이하라는 것이 보장된다.<br/>
모든 테스트 케이스에 대한 N 의 총합이 1, 000, 000을 넘지 않음이 보장된다.<br/>


## 출력
각 테스트 케이스마다 슬라임을 끝까지 합성했을 때 청구될 비용의 최솟값을 1, 000, 000, 007로 나눈 나머지를 출력한다. 전기 에너지가 전혀 필요하지 않은 경우엔 1 을 출력한다.<br/>


## 예제 입력
2<br/>
5<br/>
3 10 2 8 14<br/>
1<br/>
13<br/>

## 예제 출력
270950400<br/>
1<br/>

## 풀이
합성을 진행하는 과정을 보면 A1, A2를 합성해 나온 것을 B라 하고 합성해 나온 에너지를 E1이라하자.<br/>
그리고나서 B와 A3를 합성해 나온 에너지 E2라 하자.<br/>
그리고 E1 + E2 = E라 할때, A1, A2, A3로 표현하면 아래와 같다.<br/>
E1 = A1 x A2, E2 = (A1 x A2) x A3가 된다.<br/>
그래서 E = E1 + E2 = A1 x A2 + (A1 x A2 x A3)이다.<br/>
이때 E가 최소일 때는 A1 ≤ A2 ≤ A3일 때 임을 값을 대입하면서 진행하면 알 수 있다.<br/>
중간에 만들어진 에너지를 오름차순으로 넣어야 하기 때문에 PriorityQueue로 에너지를 관리했다.<br/>
이후 1개 입력되는 경우는 전기에너지가 전혀 필요없기에 1로 출력 해야 한다.<br/>
그리고 50만, 50만이 들어오는 경우 50만 x 50만은 int 범위를 넘어가기에 long으로 정답을 저장해야 한다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/14698