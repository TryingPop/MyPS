# C#

## 난이도 : 플레티넘 5

## 알고리즘 분류
  - 다이나믹 프로그래밍
  - 그래프 이론
  - 그래프 탐색
  - 트리
  - 깊이 우선 탐색
  - 트리에서의 다이나믹 프로그래밍

## 제한조건
  - 시간 제한 : 1.5초
  - 메모리 제한 : 128 MB

## 문제
로스팅하는 엠마는 바리스타입니다. 엠마는 N개의 정점을 가진 트리 형태의 농장 연결 시스템을 구축한 상태입니다. 트리의 정점은 1번부터 N번까지 번호가 매겨져 있습니다. 각각의 간선은 그 농장에서 다른 농장으로 이동할 수 있음을 뜻하며, 간선의 가중치는 이동 거리를 뜻합니다.<br/>
엠마는 한 개의 농장을 정해 농장 옆에 로스팅 시설을 마련하려고 합니다. 이때, 다른 농장에서 로스팅 시설까지의 거리의 합들을 알아야, 효율적으로 로스팅 시설의 위치를 정할 수 있을 것입니다. 그러므로 각각의 농장마다 다른 농장들에서 그 농장으로 가는 최단 거리들의 합을 구해줍시다.<br/>


## 입력
첫째 줄에 N이 입력됩니다. (1 ≤ N ≤ 3 × 10^5)<br/>
N-1 줄 동안 세 수 u, v 와 d가 주어집니다. 이는 u번째 농장과 v번째 농장은 서로 연결되어 있으며, 그 거리는 d임을 뜻합니다. (1 ≤ u, v ≤ N, 1 ≤ d ≤ 5)<br/>
주어지는 그래프는 트리입니다.<br/>


## 출력
N개의 줄 동안 각각의 농장에 대해 다른 농장들에서 그 농장으로 가는 최단 거리들의 합을 출력합니다.<br/>


## 예제 입력
10<br/>
1 2 1<br/>
2 3 1<br/>
2 4 1<br/>
4 7 1<br/>
4 8 1<br/>
4 5 1<br/>
1 6 1<br/>
6 9 1<br/>
6 10 1<br/>


## 예제 출력
19<br/>
17<br/>
25<br/>
19<br/>
27<br/>
23<br/>
27<br/>
27<br/>
31<br/>
31<br/>


## 풀이
그래프의 루트를 변경해도 A에서 B로 향하는 거리들은 변경되지 않는다.<br/>
그래서 트리의 루트를 1로 해서 그래프를 만든다.<br/>


위 그래프에서 dp[i] = val를 i번 노드를 루트로하는 서브트리에 각 노드에서 i로 이동하는 거리를 누적한 것이다.<br/>
그러면 i가 리프 노드면 0임이 자명하다.<br/>
i가 리프노드가 아닌 경우 i의 자식들 j에 대해 dp[j] 값과 j의 서브트리에 포함된 노드의 수 child[j]를 알면,<br/>
i에서 j로 가는 거리를 dis[i][j]라 하면 다음과 같은 점화식을 얻는다.<br/>
dp[i] = ∑dp[j] + child[j] * dis[i][j] 를 얻는다.<br/>


이렇게 루트까지 찾아가면 1인 경우에 한해 찾을 수 있다.<br/>
이제 루트에서 루트의 자식으로 바꿀 대 총합이 어떻게 변하는지 보자.<br/>
루트의 자식을 c1이라 하자.<br/>
그러면 루트 1에서 c1으로 가는 간선의 거리는 dis[1][c1]이라 하자.<br/>
1로 가는 경우를 dis[1][c1]을 이용하는 노드들을 보면 child[c1]개 이용한다.<br/>
반면 c1으로 가는 경우를 보면 dis[1][c1]은 n - child[c1]의 노드들이 이용하게 된다.<br/>
나머지 간선에 대해서는 이용하는 노드의 갯수는 변하지 않는다.<br/>
그래서 모든 노드가 c1으로 이동하는 총 거리는 dp[1] - child[c1] * dis[1][c1] + (n - child[c1]) * dis[1][c1]이 된다.<br/>
이렇게 부모노드 p에서 자식인 c의 총합 이동 거리의 차는 dis[p][c] * (n - child[c] * 2)와 같다.<br/>


이러한 사실을 이용해서 루트가 1인 그래프에대해 1로 향하는 모든 거리 총합을 찾는다.<br/>
이후 1에서부터 자식으로 이동하며 거리차를 확인하며 다른 노드로 향하는 거리의 총합을 찾았다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/15647