# C#

## 난이도 : 플레티넘 2

## 알고리즘 분류
  - 자료 구조
  - 정렬
  - 트리
  - 세그먼트 트리
  - 오프라인 쿼리
  - 오일러 경로 테크닉
  - 머지 소트 트리

## 제한조건
  - 시간 제한 : 2초
  - 메모리 제한 : 512 MB

## 문제
1부터 N까지의 번호가 부여된 N개의 정점과 N-1개의 간선으로 구성된 트리가 있다. 이 트리의 루트는 1번 정점이며, 임의의 한 정점과 다른 정점 사이의 경로가 반드시 한 개 존재한다.<br/>
트리의 각 정점은 특정 색깔을 가지고 있다. 편의상 색깔은 1 이상 C 이하의 자연수로 표현된다. 이때, 질의 f(v,c)를 다음과 같이 정의하자.<br/>
f(v, c) : 정점 v가 루트인 부트리(sub-tree)에서 색깔이 c 이하인 정점의 개수<br/>
M개의 질의 f(vi, ci)가 주어질 때, 각 질의에 대한 답을 계산하는 프로그램을 작성하시오.<br/>


## 입력
첫 번째 줄에 정점의 수를 나타내는 N(1 ≤ N ≤ 2×10^5), 질의의 개수를 나타내는 M(1 ≤ M ≤ 2×10^5), 정점의 색깔 종류를 나타내는 C(1 ≤ C ≤ N)가 공백 하나를 사이에 두고 차례로 주어진다.<br/>
두 번째 줄에는 각 정점의 색깔을 나타내는 N개의 정수가 공백으로 구분되어 순서대로 주어진다. 첫 번째 수는 1번 정점의 색깔이며, ..., N 번째 수는 N번 정점의 색깔이다.<br/>
세 번째 줄부터 N-1개의 줄에 걸쳐서 트리를 이루는 각 간선의 정보가 주어진다. 각 간선의 정보는 해당 간선을 이루는 서로 다른 두 정점의 번호로 구성된다. 각 정점의 번호는 1 이상 N 이하의 자연수이다.<br/>
이후, 이어서 M개의 줄에 걸쳐서 i번째 줄에 i번째 질의의 정보 vi, ci가 공백으로 구분되어 주어진다. vi는 1 이상 N 이하의 정점 번호를 나타낸다. ci는 1 이상 C 이하의 색깔 정보를 나타낸다.<br/>


## 출력
M개의 질의에 대한 정답을 모두 더한 뒤, 1,000,000,007로 나눈 나머지를 출력한다.<br/>


## 예제 입력
5 5 3<br/>
1 2 1 3 3<br/>
1 2<br/>
2 3<br/>
3 4<br/>
4 5<br/>
1 1<br/>
1 3<br/>
3 2<br/>
4 3<br/>
5 3<br/>


## 예제 출력
11<br/>


## 풀이
서브 트리의 모든 노드를 조사해야 한다.<br/>
그래서 오일러 경로 테크닉을 통해 새로운 인덱스를 부여하고 서브 트리의 인덱스 범위를 관리했다.<br/>
이후 C 색상 이하의 모든 노드를 찾기에 C로 정렬한 뒤 색상 입력과 갯수 찾기 쿼리로 변형해 풀었다.<br/>
정렬 기준은 색상을 기준으로 오름차순이 최우선이고 차선으로 색 넣는걸 우선적으로 했다.<br/>
이렇게 진행하면 세그먼트 트리는 색칠된 노드의 갯수와 정답이 일치하게 된다.<br/>

## 문제 링크
https://www.acmicpc.net/problem/15899