# C#

## 난이도 : 골드 4

## 알고리즘 분류
  - 누적 합

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 256 MB

## 문제
JOI나라에는 N개의 도시가 있고, 각 도시에 1,2,...,N까지의 번호를 갖고 있다.<br/>
그리고, 철도가 N-1개 있고, 각 철도에 1,2,...N-1의 번호를 갖고 있다.<br/>
철도 i (1 ≦ i ≦ N − 1)는 도시 i과 도시 i+1을 양방향으로 연결시키는 철도를 의미한다.<br/>
JOI나라의 철도를 타는 방법에는, 티켓을 구입해 승차하는 방법과 IC카드로 승차하는 방법 두 가지가 존재한다.<br/>

  - 철도 i에 티켓을 구입해 승차할 때는 Ai 원의 비용이 든다.
  - 철도 i에 IC카드로 승차하는 경우에는 Bi 원의 비용이 든다. 하지만 IC카드로 철도를 탈 때는 IC카드를 미리 구입해둬야만 한다. 철도 i에서 쓸 수 있는 IC카드를 구입하는데는 Ci원의 비용이 든다. 한번 구입한 IC카드는 몇번이라도 사용할 수 있다.

IC카드가 처리가 간편하기 때문에, IC카드로 승차하는 방법의 운임이 티켓을 구입하는 경우보다 싸다. 즉, i = 1,2,...N-1일 때 Ai > Bi이다. IC카드는 철도마다 다르기 때문에, 철도 i에서 사용할 수 있는 카드는 다른 철도에서는 사용할 수 없다.<br/>
당신은 JOI나라를 여행하기로 마음먹었다. 도시 P1에서 출발해, P2,P3... ,PM 순서의 도시를 방문할 예정이다. 여행은 M-1일간 이루어진다. j일째 (1 ≦ j ≦ M − 1) 에 도시 Pj으로부터 Pj+1으로 이동한다. 이때, 여러 개의 철도를 타는 경우도 있고, 같은 도시를 여러 번 방문할 수도 있다. JOI나라의 철도는 빨라서 어느 도시도 하루만에 도착할 수 있다<br/>
당신은 현재 어느 철도의 IC카드도 갖고있지 않다. 당신은 미리 몇개의 IC카드를 구입해, 이 여행에서 사용되는 비용, 즉 IC카드를 구입하는 비용 + 철도를 타는 비용을 최소화하고 싶다.<br/>
JOI나라의 도시 수, 여행의 기간, 그리고 JOI나라의 철도 각각의 운임과, IC카드의 가격이 주어졌을 때, 여행의 비용을 최소화하는 프로그램을 작성하시오.<br/>


## 입력
첫 번째 줄에서는 정수 N, M이 주어진다.<br/>
두 번째 줄에는 M개의 정수 P1,P2,...PM이 주어진다. j일째 (1 ≦ j ≦ M − 1) 에 도시 Pj에서 Pj+1로 이동하는 것을 의미한다.<br/>
3번째 줄부터 N-1개의 줄에는 (1 ≦ i ≦ N − 1) 3개의 정수 Ai, Bi, Ci가 주어진다. 각각 철도 i의 티켓을 구입하는 가격, 철도 i를 카드를 사용했을 때 통과하는 가격, IC카드를 구매하는 가격을 의미한다.<br/>


## 출력
여행에 드는 최저 비용을 첫째 줄에 출력하시오.<br/>


## 제한
  - 2 ≦ N ≦ 100 000．
  - 2 ≦ M ≦ 100 000．
  - 1 ≦ Bi < Ai ≦ 100 000 (1 ≦ i ≦ N − 1)．
  - 1 ≦ Ci ≦ 100 000 (1 ≦ i ≦ N − 1)．
  - 1 ≦ Pj ≦ N (1 ≦ j ≦ M)．
  - Pj ≠ Pj+1 (1 ≦ j ≦ M − 1)．


## 예제 입력
4 4<br/>
1 3 2 4<br/>
120 90 100<br/>
110 50 80<br/>
250 70 130<br/>


## 예제 출력
550<br/>


## 힌트
위의 경우, 여행에 드는 비용이 최소가 되는 방법은 아래와 같다.<br/>

  - 철도 2와 철도 3의 IC카드를 구입한다. 80+130 = 210원의 비용이 발생한다．
  - 1일째에, 도시 1에서 도시 2까지 티켓을 사용해 이동하고, 도시 2에서 도시 3까지는 IC카드를 사용해 이동한다. 120+50= 170원의 비용이 발생한다.
  - 2일째에, 도시 3에서 도시 2까지 IC카드를 사용해 이동한다. 50의 비용이 발생한다.
  - 3일째에는 도시 2에서 도시 3까지 IC카드를 사용해 이동하고, 다음으로 도시 3에서 도시 4까지 IC카드를 사용해 이동한다. 50+70 = 120원을 사용한다.

이렇게 이동하면, 여행에 드는 비용의 합계는 210+170+50+120 = 550원이 된다. 이 비용이 최소이므로, 550을 출력한다.<br/>


## 풀이
철도 이동 경로를 확인한다.<br/>
위 예제의 1 3 2 4인 경우 1번역에서 2번역을 거쳐 3번역으로 이동한다.<br/>
그리고 3번역에서 2번역으로 이동한다.<br/>
그래서 각 거치는 역의 횟수를 누적해줘야 하는데 세그먼트 트리를 이용해 i번 역을 방문하는 횟수를 저장했다.<br/>
이후 횟수를 알면 표를 횟수만큼 구매하는게 좋은지 IC 카드를 구매해서 충전하는게 좋은지 확인해 최소가되게 구매해가면 된다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/10713