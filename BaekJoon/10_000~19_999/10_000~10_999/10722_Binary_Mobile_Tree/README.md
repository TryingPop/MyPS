# C#

## 난이도 : 골드 2

## 알고리즘 분류
  - 다이나믹 프로그래밍
  - 트리
  - 트리에서의 다이나믹 프로그래밍
  - 물리학

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 256 MB

## 문제
저출산 때문에 가장 큰 고통을 받고 있는 산업분야라고 하면 역시 교육을 뽑을 수 있겠다.<br/>
점점 줄어들어만 가는 학생들 때문에 너도나도 앞장서서 자신만의 독특한 교육 아이템을 광고하곤 하는데, 이는 2D 나라에 있는 일루 유치원 역시 예외가 아니었다.<br/>
일루 유치원에서는 재학생들을 위한 놀이 활동이자 신입생 유치의 일환으로 특대형 이진 모빌 만들기에 도전하고자 한다.<br/>
일루 유치원에서 만들고자 하는 이진 모빌은 아래와 같은 모양새를 띄고 있다.<br/>
  0. 일루 유치원은 2D나라에 존재한다. 따라서 Z축이 없고, 중력은 -Y축 방향으로 작용하고 있다.
  1. 모빌은 나무 막대와 구슬, 그리고 이들을 연결하는 실로 이루어져 있다.
  2. 모든 막대는 각각 하나의 실에 매달려있으며, 1번 막대를 매달고 있는 실은 천장에 붙어있다.
  3. 각 막대의 양 끝에는 늘 실이 매달려있으며, 해당 실의 반대(아래)쪽에는 나무 막대 혹은 구슬이 매달려 있을 수 있다.
  4. 구슬들은 고유한 무게를 지니며, 막대와 실은 무게가 없다.
  5. 나무 막대와 구슬은 부피가 0인 선으로 봐도 좋으며, 구슬 역시 반지름이 0에 가까운 질량점이라고 생각할 수 있다.
  6. 모든 나무 막대는 모빌이 완성된 시점에서 수평하게(X축에 평행하게) 매달려있어야 한다.

한 편, 일루 원장선생님은 모빌을 전시하기 위한 공간 확보에 어려움을 겪고 있었다. 재료들은 있지만 완성된 모빌의 크기가 얼마나 될지 알 수가 없었기 때문이다.<br/>
일루 원장님의 절친한 친구인 당신은 그의 유치원 경영을 도와주고자 한다. 나무 막대들과 구슬간의 연결 상태가 주어질 때, 주어진 모빌의 가로 너비를 출력하는 프로그램을 작성하라.<br/>

## 입력
첫 줄에는 테스트 케이스의 수 T가 주어진다.<br/>
각 테스트 케이스의 첫 줄에는 나무 막대의 수 n(1 ≤ n ≤ 100,000)이 주어진다. 다음 n 개의 줄에 각 나무 막대의 길이를 나타내는 정수 len (1 ≤ len ≤ 1,000)과 왼쪽 / 오른쪽 실의 반대편에 매달린 물체의 정보를 나타내는 두 정수 l, r이 공백으로 구분되어 주어진다. -n ≤ l ≤ -1 일 경우에는 -l 번 나무막대가 왼쪽 끝에 달려 있다는 뜻이며, 1 ≤ l ≤ 100,000일 경우에는 왼쪽 끝에 해당 중량의 구슬이 달려있다는 뜻이다. r 역시 오른쪽 끝에 달려있는 정보를 표기한다는 점을 제외하면 l과 같이 이해하면 된다.<br/>
입력으로는 나무 막대와 구슬간의 연결상태, 각 나무 막대의 길이, 각 구슬의 중량이 주어진다.<br/>
모든 막대는 한 연결된 컴포넌트의 구성원임이 보장된다.<br/>

## 출력
각 테스트 케이스당 한 줄에 걸쳐 모빌의 폭을 출력한다.<br/>
10^-6 이하의 절대 / 상대오차는 정답으로 인정한다.<br/>

## 예제 입력
1<br/>
3<br/>
10 -2 -3<br/>
2 100 50<br/>
8 75 75<br/>

## 예제 출력
14.66666666666<br/>

## 풀이
시소를 앉을 때 무게와 사람이 앉는 위치에 따라 평형이 되는 위치가 다르다.<br/>
중심과 왼쪽의 거리를 dl, 왼쪽 무게를 wl, 중심과 오른쪽 거리를 dr, 오른쪽 무게를 wr이라하면<br/>
dl * wl = dr * wr인 경우 평형이 된다.<br/>
그리고 모빌의 입장에서 보자 다음과 같은 형태의 모빌을 생각하자.<br/>

	        |
	 -----------------  ( 1번 막대 길이 3)
	 |               |
	10          ------------  (2번 막대 길이 10)
	            |         |
	           10          10
	(실제 모양은 다르다)


2번 막대기를 보면 서로 무게가 같으므로 왼쪽 끝에서 5만큼 떨어진 곳에 중심이 잡히게 된다.<br/>
그리고 1번 막대에서 오른쪽에 매달린 2번 막대기 쪽을 보면<br/>
무게는 합연산으로 10 + 10 = 20이다. 그래서 1번 막대기에서 중심은 왼쪽의 끝에서 1이 중심이 된다.<br/>
이렇게 각 막대기에 대해 중심을 찾을 수 있다.<br/>

이제 모빌의 폭을 찾는건 해당 막대기에서 중심을 기준으로 좌우 끝의 위치를 저장하고 상대 위치로 갱신하면서 찾아갔다.<br/>
2번 막대기의 경우 막대기의 중심에서 -5, 오른쪽은 5이된다.<br/>
1번 막대기로 올라오면 왼쪽 끝을 0이라 하면 오른쪽 끝은 3이고 해당 중앙은 1에 있다.<br/>
2번 막대기 왼쪽 끝은 2에서 -5만큼 이동하면 -3의 위치가 된다. 이는 0보다 더 작으므로 왼쪽 끝은 -2가 된다.<br/>
오른쪽 끝은 3 + 5 = 8로 된다.<br/>

이 두 가지 아이디어를 이용해서 DFS로 아래부터 위 막대기로 올라왔다.<br/>

## 문제 링크
https://www.acmicpc.net/problem/10722