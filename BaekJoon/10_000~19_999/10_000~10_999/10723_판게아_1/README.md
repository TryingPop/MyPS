# C#

## 난이도 : 골드 3

## 알고리즘 분류
  - 그래프 이론
  - 최소 스패닝 트리

## 제한조건
  - 시간 제한 : 20초
  - 메모리 제한 : 256 MB

## 문제
태초에 세계는 n개의 도시와 이들 사이를 잇는 n - 1개의 도로로 이루어져 있었다. 각 도시에는 0 이상 n-1 이하의 정수 번호가 붙어 있었다. 각 도로는 양방향으로 통행 가능하며, 양 끝에 서로 다른 두 개의 도시를 연결하고 있었다. 태초에 세계는 임의의 도시에서 출발하여 다른 모든 도시로 한 개 이상의 도로를 통하여 걸어갈 수 있었다.<br/>
지혜를 갖춘 인간들은 어느새 찬란한 문명을 가지게 되었으나, 도시 사이에 새로운 도로를 놓는 일만큼은 어떻게 해도 해낼 수가 없었다.<br/>
이를 지켜보던 조물주는 해마다 두 도시를 잇는 도로를 하나씩 추가하기 시작했는데, 동시에 인간들이 새로운 도로를 사용하기에 합당한 지적 능력을 갖추고 있는지가 궁금해졌다. 그래서 인간들에게 아래와 같은 퍼즐 문제를 제시하였다.<br/>
매번 도로가 추가되고 나면 모든 도로 중 일부를 선택하여 모든 도시가 서로 직간접적으로 연결되어 있도록 하며,<br/>
이때 선택된 도로들의 길이의 합을 최소로 하는 도로의 부분집합을 알아내기.<br/>
조물주에게 문제를 받은 인간들은, 이 문제를 해결하여 조물주에게 자신들이 도로를 사용하기에 합당한 존재라는 것을 보여주기로 하였다. 만약 문제를 해결하지 못한다면, 인간들에게 실망한 조물주가 어떤 일을 일으킬지 아무도 알 수 없다. 당신은 인간계 대표로서, 조물주가 내린 시련을 이겨내야만 한다!<br/>


## 입력
첫 줄에는 테스트 케이스의 수 T가 정수로 주어진다. 이어서 매 테스트 케이스의 첫 줄에는 도시의 수 n과 도로가 건설된 횟수 m이 공백으로 구분되어 주어진다. 다음 n - 1줄에 태초의 세계에 대한 정보가 주어진다. 이 중 i (1 ≤ i ≤ n - 1)번째 줄에는 정수 u_i, c_i (0 ≤ u_i < i, 0 ≤ c_i ≤ 10,000,000)가 공백으로 구분되어 주어지는데, 이는 i번 도시와 u_i번 도시가 길이가 c_i인 도로로 연결되어 있다는 뜻이다. 이어서 m개의 줄에 조물주가 새로이 놓은 도로에 대한 정보가 주어진다. 이 중 j (1 ≤ j ≤ m)번째 줄에는 정수 u_j, v_j, c_j (0 ≤ u_j, v_j < n, 0 ≤ c_j ≤ 10,000,000)가 공백으로 구분되어 주어지는데, 이는 조물주가 j번째로 놓은 도로는, u_j번 도시와 v_j번 도시 사이를 연결하며, 길이가 c_i라는 것을 의미한다.<br/>
이 문제는 두 개의 부분문제로 이루어져 있다.<br/>
1번 문제의 입력은 1 ≤ n, m ≤ 2,000을 만족하며 해결하면 20점을 얻을 수 있다.<br/>
2번 문제의 입력은 1 ≤ n, m ≤ 100,000을 만족하며 해결하면 80점을 얻을 수 있다.<br/>

## 출력
각 테스트 케이스마다 단 하나의 줄을 출력한다. 이 줄에는 매번 새 도로를 놓았을 때 문제에 대한 답을 모두 XOR한 값을 출력한다.<br/>


## 예제 입력
1<br/>
3 3<br/>
0 5<br/>
1 3<br/>
0 2 4<br/>
0 1 2<br/>
0 0 2<br/>


## 예제 출력
7<br/>


## 풀이
모든 도시가 서로 직간접적으로 연결되어 있도록 하며 선택된 도로들의 길이 합이 최소로 하는 부분집합 만들어야 한다.<br/>
이는 최소 신장 트리를 만드는 것과 같다.<br/>


a번째 쿼리에서 만들어진 최소신장 트리가 있다고 하자.<br/>
그러면 a + 1번째의 최소신장 트리는 a번째의 도로들과 추가된 도로로 최소신장 트리를 구하는 거나 1 ~ a+1번까지 추가된 도로로 최소신장 트리를 구하는 거나 같다.<br/>
그래서 이전 최소신장의 트리 안에 포함되는 간선을 살리고 새롭게 1개씩만 추가하면 간선의 갯수는 n개로 고정된다.<br/>


n, m이 2000으로 작고 시간이 20초로 매 쿼리당 크루스칼 알고리즘을 실행해도 케이스마다 O(n x m log(n))이므로 충분히 할만하다 판단했다.<br/>
그래서 크루스칼 알고리즘(유니온 파인드, 우선순위 큐)를 이용해 매번 최소 신장 트리의 거리들을 찾아 갔다.<br/>
다만 n, m이 10만인 경우는 링크/컷 트리를 써야한다고 한다.<br/>
추후에 확인해봐야겠다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/10723