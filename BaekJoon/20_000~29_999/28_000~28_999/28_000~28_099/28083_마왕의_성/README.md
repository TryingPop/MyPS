# C#

## 난이도 : 실버 4

## 알고리즘 분류
  - 자료 구조
  - 정렬
  - 분리 집합

## 제한조건
  - 시간 제한 : 3초
  - 메모리 제한 : 1024 MB

## 문제
세계 정복의 야망을 품은 마왕은 자신의 국가를 만들기로 했다! 하지만 국가를 만들기 전, 영토를 정하거나 성을 세우는 등 해야 할 일이 많다.<br/>
영토가 될 수 있는 부지는 N x M크기의 직사각형 모양이며, 부지는 1 x 1단위 크기의 땅으로 나뉘어져 있다. 마왕은 하나 이상의 땅을 골라 자신의 영토로 선포하고, 그 중 하나의 땅에 마왕의 성을 세울 것이다. 각 땅에는 "땅의 높이"와 "얻을 수 있는 세금" 두 가지 수치가 정해져 있다. 다음 그림은 예제 2의 각 땅에서 얻을 수 있는 세금과 높이를 각각 나타낸 것이다.<br/>
마왕은 국민과의 소통을 중시하므로, 영토에 속하는 모든 땅은 상하좌우로 인접한 영토를 따라 이동해 마왕의 성에 도달할 수 있어야 한다. 또한 자신이 세상에서 가장 높은 사람이 되어야 한다는 확고한 철학이 있으므로, 마왕의 성을 세울 땅은 나머지 모든 영토의 높이보다 높거나 같아야 한다.<br/>
마왕이 얻을 수 있는 세금의 양은 영토에 포함된 각각의 땅에서 얻을 수 있는 세금의 합과 같다. 마왕은 N x M개의 땅 각각에 성을 세울 때 최대 얼마 만큼의 세금을 얻을 수 있는지 알고 싶다. 하지만 마왕은 프로그래밍을 할 줄 모르기 때문에, 마왕에게 사로잡힌 여러분이 이 문제를 해결할 프로그램을 대신 작성해 보자.<br/>


## 입력
첫째 줄에 영토가 될 수 있는 부지의 크기 N, M이 공백으로 구분되어 주어진다.<br/>
둘째 줄부터 N개의 줄에 걸쳐 i, j에 위치한 땅의 높이 h_{i, j}가 M개씩 공백으로 구분되어 주어진다.<br/>
N + 1번째 줄부터 N개의 줄에 걸쳐 i, j에 위치한 땅을 마왕의 영토로 만들 때 얻을 수 있는 세금 c_{i, j}가 M개씩 공백으로 구분되어 주어진다.<br/>


## 출력
N개의 줄에 걸쳐 각 위치에 마왕의 성이 있는 경우 영토를 적당히 선포하여 걷을 수 있는 세금의 합의 최댓값을 M개씩 공백으로 구분하여 출력한다.<br/>


## 제한
  - 1 ≤ N, M ≤ 1,000
  - 1 ≤ h_{i, j}, c_{i, j} ≤ 10^9


## 예제 입력
3 3<br/>
1 2 1<br/>
3 10 4<br/>
1 5 1<br/>
2 9 4<br/>
6 16 9<br/>
14 11 6<br/>


## 예제 출력
2 15 4<br/>
35 77 50<br/>
14 61 6<br/>


## 풀이
각 좌표마다 BFS 탐색을 하면서 세금의 합을 구한다면 N x M의 시간이 걸린다.<br/>
좌표는 N x M개 있으므로 총 시간 복잡도는 O((N x M)^2)이다.<br/>
N, M의 최댓값은 1000이므로 (N x M)^2 = 10^12로 시간초과난다.<br/>


마왕의 성을 세우는 위치보다 낮거나 같은 이어진 노드들의 세금합을 알아야 한다.<br/>
먼저 노드들을 높이로 오름차순 정렬한다.<br/>


정렬된 높이들에 대해 앞에서부터 높이가 같은 노드들을 하나씩 읽는데, 자기보다 높이가 낮은 노드들에 대해 유니온 한다.<br/>
그리고 유니온 된 그룹에 대해 두 그룹의 세금의 합을 누적해 준다.<br/>
그러면 해당 높이의 모든 노드들을 유니온 했을 때, 각 노드의 그룹에 있는 세금의 합이 우리가 찾는 자기보다 낮거나 같은 이어진 노드들의 세금합이 된다.<br/>


해당 경우 유니온 파인드 알고리즘은 N, M이 1000이하이므로 a를 아커만 함수라하면 a(N x M)은 1로 봐도 무방하다.<br/>
또한 각 노드들에 대해 인접한 노드들만 조사하면 되기에 각 노드에 대해 O(1)의 시간이 걸린다.<br/>


그래서 세금의 합을 구하는 전체 시간 복잡도는 O(N x M)에 해결 된다.<br/>
다만 높이에 대해 노드를 정렬하므로 힙 정렬을 이용할 시 N x M x log (N x M)의 시간이 걸린다.<br/>
그래서 전체 시간 복잡도는 O(N x M x log (N x M))이 된다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/28083