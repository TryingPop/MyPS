# C#

## 난이도 : 실버 5

## 알고리즘 분류
  - 수학
  - 조합론

## 제한조건
  - 시간 제한 : 1초
  - 메모리 제한 : 512 MB

## 문제
KOI 야구 리그에는 N개의 지역리그가 존재하고 각 지역리그에는 M개의 팀이 존재해서, 리그 전체로는 N x M개의 팀으로 운영되고 있다.<br/>
한 시즌에 각 팀은 같은 지역리그 팀뿐만 아니라 다른 지역리그 팀과도 경기를 해야 한다. 같은 지역리그 팀과의 팀당 경기 수는 A로 같은 지역리그 팀들에 대해서 모두 동일하다. 즉, 한 팀 X는 같은 지역리그에 있는 모든 팀 Y (≠ X)와 각각 A번의 경기를 한다. 또한 다른 지역리그 팀과의 팀당 경기 수는 B로 다른 지역리그 팀들에 대해서 모두 동일하다. 즉, 한 팀 X는 다른 지역리그에 있는 모든 팀 Z(≠ X)와 각각 B번의 경기를 한다. 단, A와 B는 A = k x B (k는 1 이상의 정수)를 만족해야 한다.<br/>
세계적 판데믹의 영향으로 올해 KOI 야구 리그는 시즌을 단축하여, 리그의 전체 경기 수가 D개 이하 이면서 D에 가장 가깝게 되도록 정하기로 했다. 따라서 같은 지역리그 팀과의 팀당 경기 수 A와 다른 지역리그 팀과의 팀당 경기 수 B를 새롭게 결정해야 한다. 물론, A = k x B를 만족해야 하고, k는 변함없이 유지되어야 한다. 또한 각 팀은 다른 팀과 적어도 한 번이상은 경기를 해야 한다. 다시 말해서, A ≥ 1, B ≥ 1을 만족해야 한다.<br/>
예를 들어, N = 2, M = 3, k = 3일 때, 경기 수 제한 D = 60이면, A = 6, B = 2일 때, 다른 지역리그 팀들과의 총 경기 수는 18이고, 같은 지역리그 팀들과의 총 경기 수는 36이다. 따라서 리그 전체 경기 수는 54로 D에 가장 가까운 새로운 경기 수이다.<br/>
지역리그의 개수 N, 각 지역리그에 속하는 팀 수 M, 그리고 위에서 A = k x B를 만족하는 정수 k, 새로운 경기 수 제한 D가 주어질 때, D 이하이면서 D에 가장 가까운 리그 전체 경기 수를 계산해서 출력하는 프로그램을 작성하시오.<br/>


## 입력
첫 번째 줄에 테스트 케이스의 개수 T가 주어진다.<br/>
다음 T개의 줄에 각 테스트 케이스의 정보가 한 줄에 하나씩 주어진다.<br/>
각 테스트 케이스는 하나의 줄에 네 개의 정수 N, M, k, D가 공백 하나를 사이로 두고 주어진다.<br/>


## 출력
T개의 각 줄에 각 테스트 케이스에 대해 리그 전체 경기 수를 출력한다.<br/>
만약 조건을 만족하는 경기 수가 존재하지 않으면 -1을 출력한다.<br/>


## 제한
  - 주어지는 모든 수는 정수이다.
  - 하나의 입력 데이터에서 1개 이상 1 000개 이하의 테스트 케이스를 해결해야 한다.
  - 2 ≤ N, M ≤ 100
  - 1 ≤ k ≤ 100
  - 1 ≤ D ≤ 1,000,000,000


## 예제 입력
3<br/>
2 3 3 60<br/>
2 2 1 18<br/>
2 2 1 4<br/>


## 예제 출력
54<br/>
18<br/>
-1<br/>


## 풀이
지역리그의 갯수를 n, 지역리그에 있는 팀의 수를 m이라 하자.<br/>
각 팀당 최소 경기 수를 찾는다.<br/>


다른 지역리그 팀과의 경기는 1번만 하는게 최소이다.<br/>
다른 지역리그의 수는 자신의 지역을 제외한 n - 1이고, 팀의 갯수는 각각 m개씩 있으므로 (n - 1) x m번 경기를 한다.<br/>


이제 같은 지역리그 팀과의 경기는 문제 조건으로 팀마다 k = 1 x k번 해야 한다.<br/>
그래서 같은 지역리그의 팀의 수는 m개인데 자신을 제외하면 m - 1이므로 (m - 1) x k번 경기를 한다.<br/>


그래서 한 팀이 경기하는 횟수를 보면 (m - 1) x k + (n - 1) x m번 경기를 한다.<br/>


전체 팀의 수가 n x m이므로 전체 최소 경기횟수는 n x m x ((m - 1) x k + (n - 1) x m)번 경기를 할것이라 생각한다.<br/>
그런데 a - b팀이 경기를 하는 경우 a팀에서 1번을 세고, b팀에서 1번을 세어 1경기당 2번씩 세는 것을 확인할 수 있다.<br/>
그래서 전체 최소 경기횟수 p = n x m x ((m - 1) x k + (n - 1) x m) / 2임을 알 수 있다.<br/>


d이하이면서 d에 가장 가까운 리그 전체 경기 수를 원한다.<br/>


이는 d < p인 경우 존재하지 않음을 알 수 있고 이 경우 문제에서 요구하는 -1을 출력하면 된다.<br/>
반면 p ≤ d인 경우, p의 배수 중에서 d 이하인 가장 큰 수는 (d // p) × p가 되므로, 이 값을 출력한다.<br/>


단순 사칙연산만 해주면 되므로 각 케이스당 O(1)에 해결이 가능하다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/21760