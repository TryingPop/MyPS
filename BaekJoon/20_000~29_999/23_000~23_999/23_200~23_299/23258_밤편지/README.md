# C#

## 난이도 : 플레티넘 5

## 알고리즘 분류
  - 다이나믹 프로그래밍
  - 그래프 이론
  - 최단 경로
  - 플로이드-워셜

## 제한조건
  - 시간 제한 : 4초
  - 메모리 제한 : 512 MB

## 문제

	이 밤 그날의 반딧불을
	당신의 창 가까이 보낼게요
	사랑한다는 말이에요
	- 아이유, 밤편지 中

선린마을에는 밤마다 소중한 사람을 향해 반딧불을 보내는 전통이 있다.<br/>
선린마을은 1번부터 N번까지의 번호가 붙은 N채의 집과 집 사이를 잇는 양방향 도로로 이루어져 있다. 반딧불은 출발지와 도착지를 직접 연결하는 길이 없거나 더 효율적인 경로가 있는 경우 다른 집들을 거쳐갈 수 있다. X번 집에는 2^X 방울의 이슬이 있으며, 반딧불은 출발지와 도착지를 제외하고 이동하는 동안 거치는 모든 집의 이슬을 반드시 모두 마셔야 한다. 안타깝게도 반딧불은 각각 상수 C를 가지고 있으며, 이슬을 2^C 방울 이상 마시면 더 이상 날아가지 않고 잠들어 버린다.<br/>
선린마을의 주민 찬우는 이슬을 2^C 방울 이상 마실 수 없는 반딧불이 s번 집에서 e번 집으로 이동하는 데 걸리는 최소 시간이 Q번이나 궁금해졌다.<br/>
찬우의 질문에 답하는 프로그램을 작성하자.<br/>

## 입력
첫째 줄에 집의 수 N과 질문의 수 Q가 주어진다.<br/>
둘째 줄부터 N줄에 걸쳐 길의 정보가 주어진다. i번 줄의 j번째 수를 D_{i,j}라고 할 때, D_{i,j}가 양의 정수라면 i번 집과 j번 집을 잇는 길을 통과하는 시간을 의미하고, 0이라면 i번 집과 j번 집 사이를 연결하는 길이 없다는 의미이다.<br/>
다음 줄부터는 Q개의 줄에 걸쳐 정수 C, s, e가 공백으로 구분되어 주어진다.<br/>
이는 이슬을 2^C 방울 이상 마실 수 없는 반딧불이 s번 집에서 e번 집으로 이동하는 데 걸리는 최소 시간을 묻는 질문이다.<br/>


## 출력
Q개의 줄에 걸쳐 질문의 답을 한 줄에 하나씩 순서대로 출력한다. 목적지에 도착하는 것이 불가능한 경우에는 -1을 출력한다.<br/>


## 제한
  - 2 ≤ N ≤ 300
  - 1 ≤ i, j ≤ N인 모든 i, j에 대해 0 ≤ D_{i, j} ≤ 170 324, D_{i, j} = D_{j, i}, D_{i, i} = 0
  - 1 ≤ Q ≤ 500,000
  - 1 ≤ s, e ≤ N
  - 1 ≤ C ≤ N + 1


## 예제 입력
4 2<br/>
0 100 1 0<br/>
100 0 0 100<br/>
1 0 0 1<br/>
0 100 1 0<br/>
3 1 4<br/>
2 4 1<br/>

## 예제 출력
200<br/>
-1<br/>

## 힌트
C = 3일 때,  1번 정점에서 4번 정점으로 가는 경로 중 3번 정점을 지나는 경로는 반딧불이 3번 정점에서 8방울의 이슬을 마시고 잠들어버리기 때문에 불가능하다. 따라서 가능한 경로는 2번 정점을 거치는 경로뿐이다.<br/>
1번 정점에서 4번 정점으로 가려면 2번 혹은 3번 정점을 반드시 거쳐야 하므로, C = 2일 때는 4번 정점에서 1번 정점으로 갈 수 없다.<br/>


## 풀이
0 ≤ a < c인 a에 대해 ∑2^a = 2^c - 1이다.<br/>
이는 c 미만인 점들을 거쳐 지나갈 수 있다.<br/>


플로이드 워셜 알고리즘을 보면, 중앙에 i를 거쳐서 지나가면서 최단 경로를 확인하는 것이다.<br/>
그래서 최단 경로를 찾는데 플로이드 워셜로 찾고, 과정을 모두 기록한다.<br/>
dp[i][j][k] = val를 0 ~ i 번 노드까지 중앙에 건너가면서 j에서 k까지 가는 최단 경로는 val가 된다.<br/>


## 문제 링크
https://www.acmicpc.net/problem/23258